<!doctype html>



  


<html class="theme-next pisces use-motion">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />












  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.4.0" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.0.2" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="jfo, blog" />





  <link rel="alternate" href="/atom.xml" title="jfo planet" type="application/atom+xml" />




  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.0.2" />






<meta name="description" content="App2SD眾所期盼可以安裝 App 到 SD card 上的功能在 2.2 上實現了，使用者在設定→應用程式→管理應用程式內可以看到新版本採用 Tab 區分不同類型的 App（以往是要按 Menu Key 選不同的 Filter 過濾出要看的 App），多了一個於 SD 卡的 Tab。     點選 Ap 後可以在手機內部記憶體跟 SD card 間自行搬移 App 存放的位置，前提是 App">
<meta property="og:type" content="article">
<meta property="og:title" content="Android 2.2 Froyo新特性">
<meta property="og:url" content="http://blog.pickbox.me/2010/07/04/Android-2-2-Froyo新特性/index.html">
<meta property="og:site_name" content="jfo planet">
<meta property="og:description" content="App2SD眾所期盼可以安裝 App 到 SD card 上的功能在 2.2 上實現了，使用者在設定→應用程式→管理應用程式內可以看到新版本採用 Tab 區分不同類型的 App（以往是要按 Menu Key 選不同的 Filter 過濾出要看的 App），多了一個於 SD 卡的 Tab。     點選 Ap 後可以在手機內部記憶體跟 SD card 間自行搬移 App 存放的位置，前提是 App">
<meta property="og:image" content="http://img.pickbox.me/wp-content/uploads/pic/bd39802629a73a288b82a148.jpg">
<meta property="og:image" content="http://img.pickbox.me/wp-content/uploads/pic/0c43552c1f838dd38b139948.jpg">
<meta property="og:image" content="http://img.pickbox.me/wp-content/uploads/pic/ff793b0142649c317aec2c4f.jpg">
<meta property="og:image" content="http://img.pickbox.me/wp-content/uploads/pic/462309f7b36cbc1d720eec19.jpg">
<meta property="og:updated_time" content="2016-10-15T05:24:27.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Android 2.2 Froyo新特性">
<meta name="twitter:description" content="App2SD眾所期盼可以安裝 App 到 SD card 上的功能在 2.2 上實現了，使用者在設定→應用程式→管理應用程式內可以看到新版本採用 Tab 區分不同類型的 App（以往是要按 Menu Key 選不同的 Filter 過濾出要看的 App），多了一個於 SD 卡的 Tab。     點選 Ap 後可以在手機內部記憶體跟 SD card 間自行搬移 App 存放的位置，前提是 App">
<meta name="twitter:image" content="http://img.pickbox.me/wp-content/uploads/pic/bd39802629a73a288b82a148.jpg">



<script type="text/javascript" id="hexo.configuration">
  var NexT = window.NexT || {};
  var CONFIG = {
    scheme: 'Pisces',
    sidebar: {"position":"left","display":"post"},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: '博主'
    }
  };
</script>




  <link rel="canonical" href="http://blog.pickbox.me/2010/07/04/Android-2-2-Froyo新特性/"/>


  <title> Android 2.2 Froyo新特性 | jfo planet </title>
</head>

<body itemscope itemtype="//schema.org/WebPage" lang="zh-Hans">

  










  
  
    
  

  <div class="container one-collumn sidebar-position-left page-post-detail ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="//schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta ">
  

  <div class="custom-logo-site-title">
    <a href="/"  class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">jfo planet</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
  <p class="site-subtitle">Hope is the best gift that tomorrow gives.</p>
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
            标签
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
            搜索
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup">
 <span class="search-icon fa fa-search"></span>
 <input type="text" id="local-search-input">
 <div id="local-search-result"></div>
 <span class="popup-btn-close">close</span>
</div>


    </div>
  
</nav>

 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="//schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                Android 2.2 Froyo新特性
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2010-07-04T19:59:00+08:00" content="2010-07-04">
              2010-07-04
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/Android/" itemprop="url" rel="index">
                    <span itemprop="name">Android</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        <p> <br>App2SD</p><p>眾所期盼可以安裝 App 到 SD card 上的功能在 2.2 上實現了，使用者在設定→應用程式→管理應用程式內可以看到新版本採用 Tab 區分不同類型的 App（以往是要按 Menu Key 選不同的 Filter 過濾出要看的 App），多了一個於 SD 卡的 Tab。     <br><a title="2010-05-21_141224.png" href="http://www.flickr.com/photos/13423557@N00/4626471086/" target="_blank" rel="external"><img src="http://img.pickbox.me/wp-content/uploads/pic/bd39802629a73a288b82a148.jpg" small="0" class="blogimg"><br><br></a></p><p>點選 Ap 後可以在手機內部記憶體跟 SD card 間自行搬移 App 存放的位置，前提是 App 要允許能夠安裝在 SD card 上。    <br><a title="2010-05-21_141335.png" href="http://www.flickr.com/photos/13423557@N00/4626471172/" target="_blank" rel="external"><img src="http://img.pickbox.me/wp-content/uploads/pic/0c43552c1f838dd38b139948.jpg" small="0" class="blogimg"><br></a></p><p>為此，新版本 SDK 在 AndroidManifest.xml 內新增了 <a href="http://developer.android.com/guide/topics/manifest/manifest-element.html#install" target="_blank" rel="external">android:installLocation</a> 屬性讓開發者決定程式是要安裝在內部記憶體還是 SD card 上，其值可以是 &quot;internalOnly&quot;、&quot;auto&quot;、&quot;preferExternal&quot; 三選一，但注意看 preferExternal 的說明</p><blockquote><p>The application prefers to be installed on the external storage (SD card). There is no guarantee that the system will honor this request. The application might be installed on internal storage if the external media is unavailable or full, or if the application uses the forward-locking mechanism (not supported on external storage). Once installed, the user can move the application to either internal or external storage through the system settings.</p></blockquote><p>但 該做的事還是沒做，對開發者來說，Android 上並沒有一個很好的防盜版機制，雖然說 forward-locking 是防心酸的，但聊勝於無。現在安裝在 SD card 上的 App 連這一點點的小保護都拿掉了，這會讓更多開發商不想進入 Android 上阿。App2SD 對使用者來說是天大的好事，但開發商要的是防盜版機制，Android 快點拿出來吧。</p>雲端備份<p>這個功能真是太讚了，以往使用者重新安裝 App（非更新 App，更新 App 資料不會遺失），之前存在 Preferences 或內部 Cache 的資料會不見，如果要做到重安裝後還能保存之前的資料，要開發者自行處理。（嗚～我處理過）</p><p>現在備份這件事 Google 幫你作掉了，對開發者來說只需要撰寫一隻 Class Extend <a href="http://developer.android.com/#backupAgent" target="_blank" rel="external">BackupAgent</a> 或 <a href="http://developer.android.com/#backupAgentHelper" target="_blank" rel="external">BackupAgentHelper</a>，在程式內說明你要備份什麼資料，然後在 AndroidManifest.xml 設定一下 <a href="http://developer.android.com/guide/topics/manifest/application-element.html#agent" target="_blank" rel="external">android:backupAgent</a>，讓系統知道這隻 App 有備份功能。</p><p>需要備份時呼叫 <a href="http://developer.android.com/reference/android/app/backup/BackupManager.html" target="_blank" rel="external">BackupManager</a> 的 <a href="http://developer.android.com/reference/android/app/backup/BackupManager.html#dataChanged%28%29" target="_blank" rel="external">dataChanged()</a>，系統會在適當的時機呼叫你寫的備份 Class，然後把資料傳上 Google 自己的 Server。</p><p>當使用者重新安裝時，系統會自動把 Server 上的資料還原到手機內，背後的備份機制開發者完全不用理會，指定好要備份的檔案即可。</p><p>這功能還是 by User Account 的，用戶換手機後可以還原同一份資料，除非手機版本差異過大無法還原，照 Google 的說法，使用者完全感覺不到備份跟還原的存在，如果是這樣 User Experience 會非常好。</p><p>參考：<a href="http://developer.android.com/guide/topics/data/backup.html" target="_blank" rel="external">Data Backup</a></p>OpenGL ES 2.0<p>在 今年三月釋出的 Android NDK Revision 3 中已經支援 OpenGL ES 2.0，不過對於不會寫 C 的開發者來說，這功能離真正應用稍微遠了點。現在 SDK 內新增了跟 NDK 內的 OpenGL ES 2.0 直接對應的接口（稱 Wrapper 好像比較恰當），Java 開發者可以無痛直接呼叫 OpenGL ES 2.0 來使用。</p><p>效能應該會比原生 C 語言差一點，不過可以用、開發快速最重要，開發遊戲的人應該很高興看到這一點。</p>語音辨識<p>對提供語音辨識的廠商來說，新版本 SDK 允許第三方應用程式以 Plug-In 的方式，透過 <a href="http://developer.android.com/reference/android/speech/RecognitionService.html" target="_blank" rel="external">RecognitionService</a> 加入自己的語音辨識引擎。</p><p>以往在 Android 內有語音辨識需求時，都要打開某個 App 才能使用，例如 <a href="http://www.google.com/mobile/voice/" target="_blank" rel="external">Google Voice</a> 或是 Voice Go，現在則是可以讓使用者設定喜歡的語音辨識引擎，當有辨識需求時系統會自動呼叫辨識引擎，等於是主動幫你打開 App 使用。</p><p>原有舊版本在設定中的文字轉語音則被改成語音輸入裝置與輸出裝置，裡面整合了原有的文字轉語音（語音輸出裝置）以及新加入的語音輸入，如果手機安裝了第三方的語音辨識引擎，就會出現在這裡。</p><p>這是安裝了 Android Sample Code 中的語音辨識引擎範例後的樣子（語音辨識引擎範例在 SDK 目錄下的 samplesandroid-8VoiceRecognitionService）     <br><a title="2010-05-21_151114.png" href="http://www.flickr.com/photos/13423557@N00/4625865191/" target="_blank" rel="external"><img src="http://img.pickbox.me/wp-content/uploads/pic/ff793b0142649c317aec2c4f.jpg" small="0" class="blogimg"><br></a></p><p>對 App 開發者來說，當有語音辨識需求時，直接傳送 <a href="http://developer.android.com/reference/android/speech/RecognizerIntent.html" target="_blank" rel="external">RecognizerIntent</a> 給系統，系統會呼叫適當的語音辨識引擎來辨識，辨識完再把結果透過 <a href="http://developer.android.com/reference/android/speech/RecognitionListener.html" target="_blank" rel="external">RecognitionListener</a> 回傳給 App，多美好的畫面阿，<a href="http://www.cyberon.com.tw/" target="_blank" rel="external">賽微科技</a>，衝阿。</p><p>PS: 賽微科技已在 Android 上發表語音辨識輸入法（賽微輕鬆說）跟應用軟體（Voice Go），個人使用過覺得辨識度已經很好，去下載來玩玩吧。</p>強化的照相機<p>新版本 Android 提高了拍照時預覽的畫面更新率(Framerate)，從 10 幾 FPS 增加到 20 幾 FPS，不過這只有拿到實機時才能驗證了。</p><p>另外新的 <a href="http://developer.android.com/reference/android/hardware/Camera.html" target="_blank" rel="external">Camera</a> Class 允許程式控制預覽時的 Zoom Level（呼叫 <a href="http://developer.android.com/reference/android/hardware/Camera.html#startSmoothZoom%28int%29" target="_blank" rel="external">startSmoothZoom()</a>），或是使用者改變 Zoom Level 時透過 <a href="http://developer.android.com/reference/android/hardware/Camera.OnZoomChangeListener.html" target="_blank" rel="external">OnZoomChangeListener</a> 主動通知 App。</p><p>預覽時畫面的方向也不再固定是右撇子順手的橫向，可以透過呼叫 <a href="http://developer.android.com/reference/android/hardware/Camera.html#setDisplayOrientation%28int%29" target="_blank" rel="external">setDisplayOrientation()</a> 來改變，有 0、90、180、270 四種可選。</p><p><a href="http://developer.android.com/reference/android/hardware/Camera.Parameters.html" target="_blank" rel="external">Camera.Parameters</a> 則提供了更多參數可以設定給 Camera 或是從 Camera 取得。還有 <a href="http://developer.android.com/reference/android/media/ThumbnailUtils.html" target="_blank" rel="external">ThumbnailUtils</a> 這隻小工具可以替圖片、影片產生縮圖。</p>放大縮小手勢<p>在支援 MultiTouch 的情況下，用戶最常使用的應該是用雙指來放大縮小螢幕上的圖片或網頁，以往都要自己寫程式碼來偵測放大縮小，現在新版本 SDK 新增 <a href="http://developer.android.com/reference/android/view/ScaleGestureDetector.html" target="_blank" rel="external">ScaleGestureDetector</a> 讓開發者直接引用，不需要再自己寫啦。</p><p>，不知道有沒有人要改寫成支援 SDK 1.5 的版本，也就是第二指的 X、Y 座標是透過 MotionEvent.toString() 取得的版本，造福大家。</p>莫名其妙<p><a href="http://developer.android.com/reference/android/view/ViewGroup.LayoutParams.html" target="_blank" rel="external">ViewGroup.LayoutParams</a> 的 fill_parent 被 deprecate，改成使用 match_parent，雖說 fill_parent 還是可以繼續使用，但沒事改這幹嘛？</p>Bug 回報<p>現在程式開發人員可以在 Developer Console 中看到自己程式的 Bug Report 了，這非 2.2 開發的程式限定，不管任何版本的程式都可以使用，主要是 Android 的手機都有一隻叫 BugReport 的系統程式在背景執行，</p><p>這對開發者來說真是一大福音，雖然無法精確到是哪個使用者做什麼動作造成的，但起碼可以知道程式是不是有發生大問題。如果還能看到使用者的評論跟線上回覆的功能就真的太美好了（做夢中）。    <br><a title="2010-05-21_162826.png" href="http://www.flickr.com/photos/13423557@N00/4626500246/" target="_blank" rel="external"><img alt="2010-05-21_162826.png" src="http://img.pickbox.me/wp-content/uploads/pic/462309f7b36cbc1d720eec19.jpg"></a></p>最後<p>Android 官網上關於 Android 2.2 更新的網頁中，跟開發者比較有關的是 <a href="http://developer.android.com/sdk/android-2.2.html" target="_blank" rel="external">Android 2.2 Platform</a> 這一頁，文中大部份都是從這頁中擷取出來。有一些本身比較少遇到的 Topic，例如 Media、Device policy manager、Accounts and sync 就沒特別拉出來說明。</p><p>官網上的許多文章也隨著新版本釋出同步更新，<a href="http://android-developers.blogspot.com/2010/05/android-22-and-developers-goodies.html" target="_blank" rel="external">Android Blog</a> 中也有一篇介紹了這次的更新，那些都值得開發者一看。</p><p>這次新版本發表，扣掉這些跟開發者比較有關的項目，使用者應該也能很明顯感受到改變，Froyo 加入了 <a href="http://zh.wikipedia.org/zh-tw/%E5%8D%B3%E6%99%82%E7%B7%A8%E8%AD%AF" target="_blank" rel="external">JIT Compilation</a>、瀏覽器換上 V8 Javascript Engine，速度都大幅增加，光是這兩點就值得更新。</p><p> </p> <p></p>

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <footer class="post-footer">
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2010/07/04/【zz】How-to-Handle-Java-Finalization-s-Memory-Retention-Issues/" rel="next" title="【zz】How to Handle Java Finalization's Memory-Retention Issues">
                <i class="fa fa-chevron-left"></i> 【zz】How to Handle Java Finalization's Memory-Retention Issues
              </a>
            
          </div>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2010/07/12/平均分布example——layoutItemsUsingGravity/" rel="prev" title="平均分布example——layoutItemsUsingGravity()">
                平均分布example——layoutItemsUsingGravity() <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          
  <div class="comments" id="comments">
    
  </div>


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap" >
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview sidebar-panel ">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="//schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/wp-content/uploads/penguin.gif"
               alt="jfo" />
          <p class="site-author-name" itemprop="name">jfo</p>
          <p class="site-description motion-element" itemprop="description"></p>
        </div>
        <nav class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="/archives">
              <span class="site-state-item-count">597</span>
              <span class="site-state-item-name">日志</span>
            </a>
          </div>

          
            <div class="site-state-item site-state-categories">
              <a href="/categories">
                <span class="site-state-item-count">36</span>
                <span class="site-state-item-name">分类</span>
              </a>
            </div>
          

          
            <div class="site-state-item site-state-tags">
              <a href="/tags">
                <span class="site-state-item-count">4</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        
          <div class="feed-link motion-element">
            <a href="/atom.xml" rel="alternate">
              <i class="fa fa-rss"></i>
              RSS
            </a>
          </div>
        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/jfojfo" target="_blank" title="GitHub">
                  
                    <i class="fa fa-fw fa-github"></i>
                  
                  GitHub
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://weibo.com/jfojfo" target="_blank" title="微博">
                  
                    <i class="fa fa-fw fa-weibo"></i>
                  
                  微博
                </a>
              </span>
            
          
        </div>

        
        

        
        
          <div class="links-of-blogroll motion-element links-of-blogroll-block">
            <div class="links-of-blogroll-title">
              <i class="fa  fa-fw fa-globe"></i>
              友情链接
            </div>
            <ul class="links-of-blogroll-list">
              
                <li class="links-of-blogroll-item">
                  <a href="http://www.pickbox.me" title="收藏夹" target="_blank">收藏夹</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="http://note.pickbox.me" title="网络剪贴板" target="_blank">网络剪贴板</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="http://iguangba.pickbox.me" title="爱逛吧" target="_blank">爱逛吧</a>
                </li>
              
            </ul>
          </div>
        

      </section>

      
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">
            
              
            
            
              <p class="post-toc-empty">此文章未包含目录</p>
            
          </div>
        </section>
      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy;  2007 - 
  <span itemprop="copyrightYear">2016</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">jfo</span>
</div>

<div class="powered-by">
  由 <a class="theme-link" href="https://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Pisces
  </a>
</div>

        

        
      </div>
    </footer>

    <div class="back-to-top">
      <i class="fa fa-arrow-up"></i>
    </div>
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  



  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.0.2"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.0.2"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.0.2"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.0.2"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.0.2"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.0.2"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.0.2"></script>



  



  




  
  
  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length == 0) {
       search_path = "search.xml";
    }
    var path = "/" + search_path;
    // monitor main search box;

    function proceedsearch() {
      $("body").append('<div class="popoverlay">').css('overflow', 'hidden');
      $('.popup').toggle();

    }
    // search function;
    var searchFunc = function(path, search_id, content_id) {
    'use strict';
    $.ajax({
        url: path,
        dataType: "xml",
        async: true,
        success: function( xmlResponse ) {
            // get the contents from search data
            isfetched = true;
            $('.popup').detach().appendTo('.header-inner');
            var datas = $( "entry", xmlResponse ).map(function() {
                return {
                    title: $( "title", this ).text(),
                    content: $("content",this).text(),
                    url: $( "url" , this).text()
                };
            }).get();
            var $input = document.getElementById(search_id);
            var $resultContent = document.getElementById(content_id);
            $input.addEventListener('input', function(){
                var matchcounts = 0;
                var str='<ul class=\"search-result-list\">';
                var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
                $resultContent.innerHTML = "";
                if (this.value.trim().length > 1) {
                // perform local searching
                datas.forEach(function(data) {
                    var isMatch = false;
                    var content_index = [];
                    var data_title = data.title.trim().toLowerCase();
                    var data_content = data.content.trim().replace(/<[^>]+>/g,"").toLowerCase();
                    var data_url = decodeURIComponent(data.url);
                    var index_title = -1;
                    var index_content = -1;
                    var first_occur = -1;
                    // only match artiles with not empty titles and contents
                    if(data_title != '') {
                        keywords.forEach(function(keyword, i) {
                            index_title = data_title.indexOf(keyword);
                            index_content = data_content.indexOf(keyword);
                            if( index_title >= 0 || index_content >= 0 ){
                                isMatch = true;
								if (i == 0) {
                                    first_occur = index_content;
                                }
                            } 
							
                        });
                    }
                    // show search results
                    if (isMatch) {
                        matchcounts += 1;
                        str += "<li><a href='"+ data_url +"' class='search-result-title'>"+ data_title +"</a>";
                        var content = data.content.trim().replace(/<[^>]+>/g,"");
                        if (first_occur >= 0) {
                            // cut out 100 characters
                            var start = first_occur - 20;
                            var end = first_occur + 80;
                            if(start < 0){
                                start = 0;
                            }
                            if(start == 0){
                                end = 50;
                            }
                            if(end > content.length){
                                end = content.length;
                            }
                            var match_content = content.substring(start, end);
                            // highlight all keywords
                            keywords.forEach(function(keyword){
                                var regS = new RegExp(keyword, "gi");
                                match_content = match_content.replace(regS, "<b class=\"search-keyword\">"+keyword+"</b>");
                            });

                            str += "<p class=\"search-result\">" + match_content +"...</p>"
                        }
                        str += "</li>";
                    }
                })};
                str += "</ul>";
                if (matchcounts == 0) { str = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>' }
                if (keywords == "") { str = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>' }
                $resultContent.innerHTML = str;
            });
            proceedsearch();
        }
    });}

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched == false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };

    });

    $('.popup-btn-close').click(function(e){
      $('.popup').hide();
      $(".popoverlay").remove();
      $('body').css('overflow', '');
    });
    $('.popup').click(function(e){
      e.stopPropagation();
    });
  </script>


  

  

  

  

  
<script type="text/javascript" src="http://p.pickbox.me/js/pv.js"></script>



</body>
</html>
