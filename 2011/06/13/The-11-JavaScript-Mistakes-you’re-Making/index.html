<!doctype html>



  


<html class="theme-next pisces use-motion">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />












  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.4.0" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.0.2" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="jfo, blog" />





  <link rel="alternate" href="/atom.xml" title="jfo planet" type="application/atom+xml" />




  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.0.2" />






<meta name="description" content="http://net.tutsplus.com/tutorials/javascript-ajax/the-10-javascript-mistakes-youre-making/节选了一部分&amp;nbsp;Mistake 2 -&amp;nbsp;You’re Not Using SemicolonsFor example, look at this simple function:function re">
<meta property="og:type" content="article">
<meta property="og:title" content="The 11 JavaScript Mistakes you’re Making">
<meta property="og:url" content="http://blog.pickbox.me/2011/06/13/The-11-JavaScript-Mistakes-you’re-Making/index.html">
<meta property="og:site_name" content="jfo planet">
<meta property="og:description" content="http://net.tutsplus.com/tutorials/javascript-ajax/the-10-javascript-mistakes-youre-making/节选了一部分&amp;nbsp;Mistake 2 -&amp;nbsp;You’re Not Using SemicolonsFor example, look at this simple function:function re">
<meta property="og:updated_time" content="2016-10-15T05:24:27.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="The 11 JavaScript Mistakes you’re Making">
<meta name="twitter:description" content="http://net.tutsplus.com/tutorials/javascript-ajax/the-10-javascript-mistakes-youre-making/节选了一部分&amp;nbsp;Mistake 2 -&amp;nbsp;You’re Not Using SemicolonsFor example, look at this simple function:function re">



<script type="text/javascript" id="hexo.configuration">
  var NexT = window.NexT || {};
  var CONFIG = {
    scheme: 'Pisces',
    sidebar: {"position":"left","display":"post"},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: '博主'
    }
  };
</script>




  <link rel="canonical" href="http://blog.pickbox.me/2011/06/13/The-11-JavaScript-Mistakes-you’re-Making/"/>


  <title> The 11 JavaScript Mistakes you’re Making | jfo planet </title>
</head>

<body itemscope itemtype="//schema.org/WebPage" lang="zh-Hans">

  










  
  
    
  

  <div class="container one-collumn sidebar-position-left page-post-detail ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="//schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta ">
  

  <div class="custom-logo-site-title">
    <a href="/"  class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">jfo planet</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
  <p class="site-subtitle">Hope is the best gift that tomorrow gives.</p>
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
            标签
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
            搜索
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup">
 <span class="search-icon fa fa-search"></span>
 <input type="text" id="local-search-input">
 <div id="local-search-result"></div>
 <span class="popup-btn-close">close</span>
</div>


    </div>
  
</nav>

 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="//schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                The 11 JavaScript Mistakes you’re Making
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2011-06-13T11:41:00+08:00" content="2011-06-13">
              2011-06-13
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/python-js-php-html-mysql-http/" itemprop="url" rel="index">
                    <span itemprop="name">python/js/php/html/mysql/http</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
         <p><a href="http://net.tutsplus.com/tutorials/javascript-ajax/the-10-javascript-mistakes-youre-making/" target="_blank" rel="external">http://net.tutsplus.com/tutorials/javascript-ajax/the-10-javascript-mistakes-youre-making/</a></p><p>节选了一部分</p><p>&nbsp;</p><p>Mistake 2 -&nbsp;You’re Not Using Semicolons</p><p></p><p>For example, look at this simple function:</p><a href="http://net.tutsplus.com/tutorials/ -ajax/the-10- -mistakes-youre-making/#" target="_blank" rel="external"></a><p></p><p>function returnPerson (name) { &nbsp;</p><p>&nbsp; &nbsp; return &nbsp;</p><p>&nbsp; &nbsp; { &nbsp;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; name : name &nbsp;</p><p>&nbsp; &nbsp; }; &nbsp;</p><p>} &nbsp;</p><p></p><p>This looks like it should return a cute little object … but in reality, the JavaScript compiler assumes you meant to put a semicolon after&nbsp;return, and will therefore return nothing; that object will get ignored. Your solution would be to do this:</p><a href="http://net.tutsplus.com/tutorials/ -ajax/the-10- -mistakes-youre-making/#" target="_blank" rel="external"></a><p></p><p>return { &nbsp;</p><p>&nbsp; &nbsp; name : name &nbsp;</p><p>};</p><p>&nbsp;</p><p></p><p></p><p>Mistake 5 - You’re not Property-Checking when Using For-In</p><p>&nbsp;</p><p>We’re all familiar with iterating over arrays; however, you’ll probably find yourself wanting to iterate over the properties of an object. (Digression: the items in an array are actually just numbered properties in an object.) If you’ve done this before, you’ve used a for-in loop:</p><p>view plaincopy to clipboardprint?</p><p>&nbsp;</p><p>&nbsp; &nbsp;1. var prop, obj = { name: &quot;Joe&quot;, job: &quot;Coder&quot;, age: 25 }; &nbsp;</p><p>&nbsp; &nbsp;2. &nbsp;&nbsp;</p><p>&nbsp; &nbsp;3. for (var prop in obj) { &nbsp;</p><p>&nbsp; &nbsp;4. &nbsp; console.log(prop + &quot;: &quot; + obj[prop]); &nbsp;</p><p>&nbsp; &nbsp;5. } &nbsp;</p><p>&nbsp;</p><p>var prop, obj = { name: &quot;Joe&quot;, job: &quot;Coder&quot;, age: 25 };</p><p>&nbsp;</p><p>for (var prop in obj) {</p><p>&nbsp; console.log(prop + &quot;: &quot; + obj[prop]);</p><p>}</p><p>&nbsp;</p><p>If you run the above code, you should see this output:</p><p>&nbsp;</p><p>&nbsp; &nbsp;1. name: Joe &nbsp;</p><p>&nbsp; &nbsp;2. job: Coder &nbsp;</p><p>&nbsp; &nbsp;3. age: 25 &nbsp;</p><p>&nbsp;</p><p>name: Joe</p><p>job: Coder</p><p>age: 25</p><p>&nbsp;</p><p>However, browsers will include properties and methods from further up the prototype chain. Most of the time you won’t want to see these when enumerating properties. You should be using the hasOwnProperties to filter out properties that aren’t actually on the object:</p><p>view plaincopy to clipboardprint?</p><p>&nbsp;</p><p>&nbsp; &nbsp;1. Function Dog (name) { &nbsp;</p><p>&nbsp; &nbsp;2. &nbsp; &nbsp; this.name = name; &nbsp;</p><p>&nbsp; &nbsp;3. } &nbsp;</p><p>&nbsp; &nbsp;4. Dog.prototype.legs = 4; &nbsp;</p><p>&nbsp; &nbsp;5. Dog.prototype.speak = function () { &nbsp;</p><p>&nbsp; &nbsp;6. &nbsp; &nbsp; return &quot;woof!&quot;; &nbsp;</p><p>&nbsp; &nbsp;7. }; &nbsp;</p><p>&nbsp; &nbsp;8. &nbsp;&nbsp;</p><p>&nbsp; &nbsp;9. var d = new Dog(&quot;Bowser&quot;); &nbsp;</p><p>&nbsp; 10. &nbsp;&nbsp;</p><p>&nbsp; 11. for (var prop in d) { &nbsp;</p><p>&nbsp; 12. &nbsp; &nbsp; console.log( prop + &quot;: &quot; + d[prop] ); &nbsp;</p><p>&nbsp; 13. } &nbsp;</p><p>&nbsp; 14. &nbsp;&nbsp;</p><p>&nbsp; 15. console.log(&quot;=====&quot;); &nbsp;</p><p>&nbsp; 16. &nbsp;&nbsp;</p><p>&nbsp; 17. for (var prop in d) { &nbsp;</p><p>&nbsp; 18. &nbsp; if (d.hasOwnProperty(prop)) { &nbsp;</p><p>&nbsp; 19. &nbsp; &nbsp; console.log( prop + &quot;: &quot; + d[prop] ); &nbsp;</p><p>&nbsp; 20. &nbsp; } &nbsp;</p><p>&nbsp; 21. } &nbsp;</p><p>&nbsp; 22. &nbsp;&nbsp;</p><p>&nbsp; 23. // Output &nbsp;</p><p>&nbsp; 24. &nbsp;&nbsp;</p><p>&nbsp; 25. // name: Bowser &nbsp;</p><p>&nbsp; 26. // legs: 4 &nbsp;</p><p>&nbsp; 27. // speak: function () { &nbsp;</p><p>&nbsp; 28. &nbsp; &nbsp; &nbsp; &nbsp; return &quot;woof!&quot;; &nbsp;</p><p>&nbsp; 29. // } &nbsp;</p><p>&nbsp; 30. // ===== &nbsp;</p><p>&nbsp; 31. // name: Bowser &nbsp;</p><p>&nbsp;</p><p>Function Dog (name) {</p><p>&nbsp; &nbsp; this.name = name;</p><p>}</p><p>Dog.prototype.legs = 4;</p><p>Dog.prototype.speak = function () {</p><p>&nbsp; &nbsp; return &quot;woof!&quot;;</p><p>};</p><p>&nbsp;</p><p>var d = new Dog(&quot;Bowser&quot;);</p><p>&nbsp;</p><p>for (var prop in d) {</p><p>&nbsp; &nbsp; console.log( prop + &quot;: &quot; + d[prop] );</p><p>}</p><p>&nbsp;</p><p>console.log(&quot;=====&quot;);</p><p>&nbsp;</p><p>for (var prop in d) {</p><p>&nbsp; if (d.hasOwnProperty(prop)) {</p><p>&nbsp; &nbsp; console.log( prop + &quot;: &quot; + d[prop] );</p><p>&nbsp; }</p><p>}</p><p>&nbsp;</p><p>// Output</p><p>&nbsp;</p><p>// name: Bowser</p><p>// legs: 4</p><p>// speak: function () {</p><p>&nbsp; &nbsp; &nbsp; &nbsp; return &quot;woof!&quot;;</p><p>// }</p><p>// =====</p><p>// name: Bowser</p><p>&nbsp;</p><p></p><p>&nbsp;</p><p></p><p>Mistake 9 - You’re Adding Elements to the DOM Individually</p><p>&nbsp;</p><p>All right, all right: this isn’t really JavaScript itself. But, in 99 of 100 cases, JavaScript means using the DOM. While there’s a lot of mistakes you can make when working with the DOM, this is a big one.</p><p>&nbsp;</p><p>I fondly remember the day when I inserted my first DOM element via JavaScript. It’s fun to do, and oh-so-useful, but it unfortunately is a strain on the page: inserting a DOM element forces the browser to completely repaint the page, so if you have a whole bunch of elements to add, adding them one by one is a bad idea:</p><p>view plaincopy to clipboardprint?</p><p>&nbsp;</p><p>&nbsp; &nbsp;1. var list = document.getElementById(&quot;list&quot;), &nbsp;</p><p>&nbsp; &nbsp;2. &nbsp; &nbsp; items = [&quot;one&quot;, &quot;two&quot;, &quot;three&quot;, &quot;four&quot;], &nbsp;</p><p>&nbsp; &nbsp;3. &nbsp; &nbsp; el; &nbsp;</p><p>&nbsp; &nbsp;4. &nbsp;&nbsp;</p><p>&nbsp; &nbsp;5. for (var i = 0; items[i]; i++) { &nbsp;</p><p>&nbsp; &nbsp;6. &nbsp; el = document.createElement(&quot;li&quot;); &nbsp;</p><p>&nbsp; &nbsp;7. &nbsp; el.appendChild( document.createTextNode(items[i]) ); &nbsp;</p><p>&nbsp; &nbsp;8. &nbsp; list.appendChild(el); // slow, bad idea &nbsp;</p><p>&nbsp; &nbsp;9. } &nbsp;</p><p>&nbsp;</p><p>var list = document.getElementById(&quot;list&quot;),</p><p>&nbsp; &nbsp; items = [&quot;one&quot;, &quot;two&quot;, &quot;three&quot;, &quot;four&quot;],</p><p>&nbsp; &nbsp; el;</p><p>&nbsp;</p><p>for (var i = 0; items[i]; i++) {</p><p>&nbsp; el = document.createElement(&quot;li&quot;);</p><p>&nbsp; el.appendChild( document.createTextNode(items[i]) );</p><p>&nbsp; list.appendChild(el); // slow, bad idea</p><p>}</p><p>&nbsp;</p><p>Here’s what you should do instead: use document fragments. Document fragments are a container to hold DOM elements; then instead of inserting each element individually, you can insert them all at once. The document fragment isn’t a node in itself and there will be nothing to show for it in the DOM: it’s just an invisible net for holding DOM elements before you put them into the DOM. So, here’s how you do it:</p><p>view plaincopy to clipboardprint?</p><p>&nbsp;</p><p>&nbsp; &nbsp;1. var list = document.getElementById(&quot;list&quot;), &nbsp;</p><p>&nbsp; &nbsp;2. &nbsp; &nbsp; frag = document.createDocumentFragment(), &nbsp;</p><p>&nbsp; &nbsp;3. &nbsp; &nbsp; items = [&quot;one&quot;, &quot;two&quot;, &quot;three&quot;, &quot;four&quot;], &nbsp;</p><p>&nbsp; &nbsp;4. &nbsp; &nbsp; el; &nbsp;</p><p>&nbsp; &nbsp;5. &nbsp;&nbsp;</p><p>&nbsp; &nbsp;6. for (var i = 0; items[i]; i++) { &nbsp;</p><p>&nbsp; &nbsp;7. &nbsp; el = document.createElement(&quot;li&quot;); &nbsp;</p><p>&nbsp; &nbsp;8. &nbsp; el.appendChild( document.createTextNode(items[i]) ); &nbsp;</p><p>&nbsp; &nbsp;9. &nbsp; frag.appendChild(el); // better! &nbsp;</p><p>&nbsp; 10. } &nbsp;</p><p>&nbsp; 11. &nbsp;&nbsp;</p><p>&nbsp; 12. list.appendChild(frag); &nbsp;</p><p>&nbsp;</p><p>var list = document.getElementById(&quot;list&quot;),</p><p>&nbsp; &nbsp; frag = document.createDocumentFragment(),</p><p>&nbsp; &nbsp; items = [&quot;one&quot;, &quot;two&quot;, &quot;three&quot;, &quot;four&quot;],</p><p>&nbsp; &nbsp; el;</p><p>&nbsp;</p><p>for (var i = 0; items[i]; i++) {</p><p>&nbsp; el = document.createElement(&quot;li&quot;);</p><p>&nbsp; el.appendChild( document.createTextNode(items[i]) );</p><p>&nbsp; frag.appendChild(el); // better!</p><p>}</p><p>&nbsp;</p><p>list.appendChild(frag);</p><p>&nbsp;</p><p>Faster, quicker, cleaner—what’s not to love?</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p></p><p></p> 
      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <footer class="post-footer">
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2011/06/13/HTML5-in-5-minutes/" rel="next" title="HTML5 in 5 minutes">
                <i class="fa fa-chevron-left"></i> HTML5 in 5 minutes
              </a>
            
          </div>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2011/06/16/mobile-development-platforms/" rel="prev" title="mobile development platforms">
                mobile development platforms <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          
  <div class="comments" id="comments">
    
  </div>


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap" >
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview sidebar-panel ">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="//schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/wp-content/uploads/penguin.gif"
               alt="jfo" />
          <p class="site-author-name" itemprop="name">jfo</p>
          <p class="site-description motion-element" itemprop="description"></p>
        </div>
        <nav class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="/archives">
              <span class="site-state-item-count">595</span>
              <span class="site-state-item-name">日志</span>
            </a>
          </div>

          
            <div class="site-state-item site-state-categories">
              <a href="/categories">
                <span class="site-state-item-count">36</span>
                <span class="site-state-item-name">分类</span>
              </a>
            </div>
          

          
            <div class="site-state-item site-state-tags">
              <a href="/tags">
                <span class="site-state-item-count">4</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        
          <div class="feed-link motion-element">
            <a href="/atom.xml" rel="alternate">
              <i class="fa fa-rss"></i>
              RSS
            </a>
          </div>
        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/jfojfo" target="_blank" title="GitHub">
                  
                    <i class="fa fa-fw fa-github"></i>
                  
                  GitHub
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://weibo.com/jfojfo" target="_blank" title="微博">
                  
                    <i class="fa fa-fw fa-weibo"></i>
                  
                  微博
                </a>
              </span>
            
          
        </div>

        
        

        
        
          <div class="links-of-blogroll motion-element links-of-blogroll-block">
            <div class="links-of-blogroll-title">
              <i class="fa  fa-fw fa-globe"></i>
              友情链接
            </div>
            <ul class="links-of-blogroll-list">
              
                <li class="links-of-blogroll-item">
                  <a href="http://www.pickbox.me" title="收藏夹" target="_blank">收藏夹</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="http://note.pickbox.me" title="网络剪贴板" target="_blank">网络剪贴板</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="http://iguangba.pickbox.me" title="爱逛吧" target="_blank">爱逛吧</a>
                </li>
              
            </ul>
          </div>
        

      </section>

      
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">
            
              
            
            
              <p class="post-toc-empty">此文章未包含目录</p>
            
          </div>
        </section>
      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy;  2007 - 
  <span itemprop="copyrightYear">2016</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">jfo</span>
</div>

<div class="powered-by">
  由 <a class="theme-link" href="https://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Pisces
  </a>
</div>

        

        
      </div>
    </footer>

    <div class="back-to-top">
      <i class="fa fa-arrow-up"></i>
    </div>
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  



  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.0.2"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.0.2"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.0.2"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.0.2"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.0.2"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.0.2"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.0.2"></script>



  



  




  
  
  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length == 0) {
       search_path = "search.xml";
    }
    var path = "/" + search_path;
    // monitor main search box;

    function proceedsearch() {
      $("body").append('<div class="popoverlay">').css('overflow', 'hidden');
      $('.popup').toggle();

    }
    // search function;
    var searchFunc = function(path, search_id, content_id) {
    'use strict';
    $.ajax({
        url: path,
        dataType: "xml",
        async: true,
        success: function( xmlResponse ) {
            // get the contents from search data
            isfetched = true;
            $('.popup').detach().appendTo('.header-inner');
            var datas = $( "entry", xmlResponse ).map(function() {
                return {
                    title: $( "title", this ).text(),
                    content: $("content",this).text(),
                    url: $( "url" , this).text()
                };
            }).get();
            var $input = document.getElementById(search_id);
            var $resultContent = document.getElementById(content_id);
            $input.addEventListener('input', function(){
                var matchcounts = 0;
                var str='<ul class=\"search-result-list\">';
                var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
                $resultContent.innerHTML = "";
                if (this.value.trim().length > 1) {
                // perform local searching
                datas.forEach(function(data) {
                    var isMatch = false;
                    var content_index = [];
                    var data_title = data.title.trim().toLowerCase();
                    var data_content = data.content.trim().replace(/<[^>]+>/g,"").toLowerCase();
                    var data_url = decodeURIComponent(data.url);
                    var index_title = -1;
                    var index_content = -1;
                    var first_occur = -1;
                    // only match artiles with not empty titles and contents
                    if(data_title != '') {
                        keywords.forEach(function(keyword, i) {
                            index_title = data_title.indexOf(keyword);
                            index_content = data_content.indexOf(keyword);
                            if( index_title >= 0 || index_content >= 0 ){
                                isMatch = true;
								if (i == 0) {
                                    first_occur = index_content;
                                }
                            } 
							
                        });
                    }
                    // show search results
                    if (isMatch) {
                        matchcounts += 1;
                        str += "<li><a href='"+ data_url +"' class='search-result-title'>"+ data_title +"</a>";
                        var content = data.content.trim().replace(/<[^>]+>/g,"");
                        if (first_occur >= 0) {
                            // cut out 100 characters
                            var start = first_occur - 20;
                            var end = first_occur + 80;
                            if(start < 0){
                                start = 0;
                            }
                            if(start == 0){
                                end = 50;
                            }
                            if(end > content.length){
                                end = content.length;
                            }
                            var match_content = content.substring(start, end);
                            // highlight all keywords
                            keywords.forEach(function(keyword){
                                var regS = new RegExp(keyword, "gi");
                                match_content = match_content.replace(regS, "<b class=\"search-keyword\">"+keyword+"</b>");
                            });

                            str += "<p class=\"search-result\">" + match_content +"...</p>"
                        }
                        str += "</li>";
                    }
                })};
                str += "</ul>";
                if (matchcounts == 0) { str = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>' }
                if (keywords == "") { str = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>' }
                $resultContent.innerHTML = str;
            });
            proceedsearch();
        }
    });}

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched == false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };

    });

    $('.popup-btn-close').click(function(e){
      $('.popup').hide();
      $(".popoverlay").remove();
      $('body').css('overflow', '');
    });
    $('.popup').click(function(e){
      e.stopPropagation();
    });
  </script>


  

  

  

  

  
<script type="text/javascript">
function attach () {
    $('body').append('<img src="http://p.pickbox.me/pv">');
    $(document).unbind('scroll', attach);
}
$(document).bind('scroll', attach);
</script>



</body>
</html>
