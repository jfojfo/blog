<!doctype html>



  


<html class="theme-next pisces use-motion">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />












  
  
  <link href="/vendors/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/vendors/font-awesome/css/font-awesome.min.css?v=4.4.0" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.0.2" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="jfo, blog" />





  <link rel="alternate" href="/atom.xml" title="jfo planet" type="application/atom+xml" />




  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.0.2" />






<meta name="description" content="&amp;nbsp;
=================================================================
Javascript 动画框架
http://madrobby.github.com/scriptaculous/
CSS3 和 JavaScript 特效
&amp;nbsp;
=========================================">
<meta property="og:type" content="article">
<meta property="og:title" content="JavaScript语法参考">
<meta property="og:url" content="http://blog.pickbox.me/2009/07/31/JavaScript语法参考/index.html">
<meta property="og:site_name" content="jfo planet">
<meta property="og:description" content="&amp;nbsp;
=================================================================
Javascript 动画框架
http://madrobby.github.com/scriptaculous/
CSS3 和 JavaScript 特效
&amp;nbsp;
=========================================">
<meta property="og:updated_time" content="2016-10-15T05:24:27.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="JavaScript语法参考">
<meta name="twitter:description" content="&amp;nbsp;
=================================================================
Javascript 动画框架
http://madrobby.github.com/scriptaculous/
CSS3 和 JavaScript 特效
&amp;nbsp;
=========================================">



<script type="text/javascript" id="hexo.configuration">
  var NexT = window.NexT || {};
  var CONFIG = {
    scheme: 'Pisces',
    sidebar: {"position":"left","display":"post"},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: '博主'
    }
  };
</script>




  <link rel="canonical" href="http://blog.pickbox.me/2009/07/31/JavaScript语法参考/"/>


  <title> JavaScript语法参考 | jfo planet </title>
</head>

<body itemscope itemtype="//schema.org/WebPage" lang="zh-Hans">

  










  
  
    
  

  <div class="container one-collumn sidebar-position-left page-post-detail ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="//schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta ">
  

  <div class="custom-logo-site-title">
    <a href="/"  class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">jfo planet</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
  <p class="site-subtitle">Hope is the best gift that tomorrow gives.</p>
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br />
            
            搜索
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup">
 <span class="search-icon fa fa-search"></span>
 <input type="text" id="local-search-input">
 <div id="local-search-result"></div>
 <span class="popup-btn-close">close</span>
</div>


    </div>
  
</nav>

 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="//schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                JavaScript语法参考
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2009-07-31T14:45:00+08:00" content="2009-07-31">
              2009-07-31
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/js-html-python/" itemprop="url" rel="index">
                    <span itemprop="name">js/html/python</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        <p>&nbsp;</p>
<p>=================================================================</p>
<p>Javascript 动画框架</p>
<p><a href="http://madrobby.github.com/scriptaculous/" target="_blank">http://madrobby.github.com/scriptaculous/</a></p>
<p><a href="http://blog.pickbox.me/2012/04/30/css3%20%E5%92%8C%20javascript%20%E7%89%B9%E6%95%88/" target="_blank">CSS3 和 JavaScript 特效</a></p>
<p>&nbsp;</p>
<p>=================================================================</p>
<p><a href="http://blog.pickbox.me/2011/07/17/%E6%96%B0%E6%B5%AA%E5%BE%AE%E5%8D%9A%E7%9A%84xss%E6%94%BB%E5%87%BB%E7%9A%84js%E4%BB%A3%E7%A0%81/" target="_blank">新浪微博的XSS攻击的JS代码</a></p>
<p>=================================================================</p>
<p><a href="http://blog.pickbox.me/2011/06/13/The%2011%20JavaScript%20Mistakes%20youre%20Making/" target="_blank">The 11 JavaScript Mistakes you’re Making</a></p>
<p>=================================================================</p>
<p><a href="http://blog.pickbox.me/2011/06/10/%E5%85%B3%E4%BA%8Ejavascript%E7%9A%84%E5%8D%95%E7%BA%BF%E7%A8%8B%E6%A8%A1%E5%9E%8B/" target="_blank">关于JavaScript的单线程模型</a></p>
<p>=================================================================</p>
<p><a href="http://blog.pickbox.me/2011/06/03/js%E5%AE%9E%E7%8E%B0%20file%20download/" target="_blank">JS实现 File Download</a></p>
<p>=================================================================</p>
<p><a href="http://blog.pickbox.me/2011/06/11/javascript%20equality%20%28%3d%3d%29%20and%20identity%20%28%3d%3d%3d%29/" target="_blank">JavaScript Equality (==) and Identity (===)</a></p>
<p>=================================================================</p>
<p><strong><a href="http://blog.pickbox.me/2012/05/21/javascript%E5%8E%9F%E5%9E%8B%E5%92%8C%E7%BB%A7%E6%89%BF/" target="_blank">JavaScript原型和继承</a>，<a href="http://blog.pickbox.me/2012/11/28/javascript%E5%8E%9F%E5%9E%8B%E5%92%8C%E7%BB%A7%E6%89%BF-a-special-example-by-jfo/" target="_blank">a special example by jfo</a>，<a href="http://blog.pickbox.me/2012/11/30/javascript%E7%9A%84%E6%9E%84%E9%80%A0%E5%87%BD%E6%95%B0%E5%92%8Cconstructor%E5%B1%9E%E6%80%A7/" target="_blank">Javascript的构造函数和constructor属性</a></strong></p>
<p>=================================================================</p>
<p><a href="http://blog.pickbox.me/2012/11/30/jquery%E4%B8%ADdeferred%E7%9A%84%E5%AE%9E%E7%8E%B0%E5%8E%9F%E7%90%86/" target="_blank">jQuery中Deferred的实现原理</a></p>
<p><span>=================================================================</span></p>
<p><span> </span></p>
<p>关于new function(…)初始化</p>
<p><strong>function f()<br>{<br>this.v = 0;<br>}<br>var a = new f();<br>alert(a.v);<br>alert(a.length);<br></strong>输出：<br>0<br>undefined</p>
<p><strong>function f()<br>{<br>this.v = 0;<br>return new Array(“j”, “f”, “o”);<br>}<br>var a = new f();<br>alert(a.v);<br>alert(a.length);<br>alert(a[0]);<br></strong>输出：<br>undefined<br>3<br>j</p>
<p>说明创建一个object时，该function的return语句将覆盖new新创建的对象。</p>
<p>function很特殊，它可以作为函数直接被调用；也可以用作创建新的object（通过new function(…)），此时<br>function的函数体则扮演了构造函数的角色。</p>
<p>看看jquery（v1.3.2）<br><strong>(function(){<br>var   jQuery = window.jQuery = window.$ = function( selector, context ) {<br>// The jQuery object is actually just the init constructor ‘enhanced’<br>return new jQuery.fn.init( selector, context );<br>},<br>jQuery.fn = jQuery.prototype = {<br>init: function( selector, context ) {<br>…<br>}<br>}；<br>jQuery.fn.init.prototype = jQuery.fn;<br>…<br>})();<br></strong>$(“body”)：以函数调用的形式创建新对象（<strong>return new jQuery.fn.init( selector, context );</strong>）<br>var J = new jQuery(“body”)：以new function(…)的形式创建新对象，return返回的对象覆盖new的对象<br>两者最终返回的完全一样。</p>
<p>=================================================================<br>function的类静态变量（Instance Property、Class Property、Prototype Property）</p>
<p>实例对象访问不到function（类似于C++中的class）中的所谓静态变量</p>
<p><strong>function f()<br>{<br>f.v_class = 1;<br>this.v_object = 0;<br>}<br>var a = new f();<br>alert(a.v_class);<br>alert(a.v_object);<br></strong>输出：<br>undefined<br>0</p>
<p>typeof(f)将输出function，可以将f看做一个特殊的object，那么f.v_class = 1就是给 f 这个object添加<br>一个属性，a自然不可以访问到 f 的属性，这样解释了为什么a.v_class是undefined，从这一点看，<br>静态变量没什么特殊之处，仅仅为function object的普通属性而已。<br>另外由于每次调用f()这个函数，涉及到都是同一个对象f，f属性的变化是可积累的，于是表现形式<br>和C++中的静态变量一样。</p>
<p>new的过程可以看做先分配一块内存空间赋给this，然后调用f()完成初始化（f()相当于构造函数），<br>在f()函数体内执行正常的JavaScript语句流程，碰到this替换为当前对象的地址，再对相应字段赋值；<br>碰到f.property对 f 这个”对象”的property属性进行操作；并无特殊之处。</p>
<p>另外，如果直接调用f()函数，则this将变成全局的那个this，在浏览器中为window对象。</p>
<p>ps：通过prototype访问<br><strong>function f()<br>{<br>this.v_object = 0;<br>}<br></strong><strong>f.v_prototype = 1;</strong><br><strong>var a = new f();<br>alert(a.v_prototype);<br>alert(a.v_object);<br></strong>输出：<br>1<br>0</p>
<p>=================================================================<br>Array类型——function object</p>
<p>Array、Number、String、Date、Function等类型，可以进行如下操作</p>
<p><strong>var T = Array;<br>var a = new T(“1111”, “222”, “33”);<br>alert(a);<br>alert(a.length);<br></strong><strong><br>T = String;<br></strong><strong>a = new T(“1111”, “222”, “33”);</strong><br><strong>alert(a);<br>alert(a.length);</strong>输出：<br>1111,222,33<br>3<br>1111<br>4</p>
<p>Array等可以用function Array() {…}的形式定义，看作function object，可被赋值，正如可以进行一下操作一样：<br>var func = function() { alert(“Hello”); }<br>func();</p>
<p>=================================================================<br>Enumerating Properties</p>
<p><strong>for (var prop in document)<br>document.write(‘document[“‘ + prop + ‘“] = ‘ + document[prop] + ‘&lt;br /&gt; ‘);<br></strong>输出：<br>document[“addEventListener”] = function addEventListener() {     [native code] }<br>document[“evaluate”] = function evaluate() {     [native code] }<br>document[“createExpression”] = function createExpression() {     [native code] }<br>document[“createNSResolver”] = function createNSResolver() {     [native code] }<br>document[“baseURI”] = file:///E:/work/Cygwin/home/Administrator/sh_script/js/js_template.html<br>document[“textContent”] = null<br>document[“nodeType”] = 9<br>document[“localName”] = null<br><strong>…</strong></p>
<p>=================================================================<br>Objects Are Reference Types</p>
<p>var str1 = “abc”;<br>var str2 = “abc”;<br>alert(str1 == str2);<br>===&gt;true</p>
<p>var str1 = new String(“abc”);<br>var str2 = new String(“abc”);<br>alert(str1 == str2);<br>===&gt; false  [the <strong>== </strong>operator checks whether the two variables refer to the exact same object]</p>
<p>var n1 = Number(314);<br>var n2 = Number(314);<br>alert(n2.valueOf() == n1.valueOf());<br>===&gt;true</p>
<p><em>The relational comparison operators  (</em>&gt;&gt;<em>,</em>&lt;&lt;<em>,</em>&gt;&gt;<strong><em>=</em></strong><em>,  and</em>&lt;&lt;<strong><em>=</em></strong><em>) work as you would expect for objects  for which these operators make sense (e.g., </em><em>, </em><em>, </em><em>, and so on). The reason is  that these operators automatically convert their operands to a primitive type.</em><em>The equality relational operator doesn’t do this because you might actually want  to compare references.</em></p>
<p>=================================================================<br>Prototype-Based Objects</p>
<p>Java and C++ are <em>class-based</em>object-oriented languages. An object’s properties are defined by its <strong>class</strong>—a description of the code and data that each object of that  class contains. In these languages, a class is defined at compile-time, that is,  by the source code the programmer writes. You can’t add new properties and  methods to a class at runtime, and a program can’t create new data types while  it’s running.</p>
<p>Because JavaScript is interpreted (and therefore has no visible  distinction between compile-time and runtime), a more dynamic approach is called  for. JavaScript doesn’t have a formal notion of a class; instead, you create new  types of objects on the fly, and you can modify the properties of existing  objects whenever you please.</p>
<p>JavaScript is a <em>prototype-based</em>object-oriented language, meaning that every object has a prototype, an object  from which it inherits properties and methods. When a property of an object is  accessed or a method invoked, the interpreter first checks to see if the object  has an instance property of the same name. If so, the instance property is used.  If not, the interpreter checks the object’s prototype for the appropriate  property. In this way the properties and methods common to all objects of that  type can be encapsulated in the prototype, and each object can have instance  properties representing the specific data for that object.</p>
<p>An object’s prototype is also an object, and can therefore itself have a  prototype.</p>
<p>&nbsp;</p>
<p>Property</p>
<p>Description</p>
<p><strong>prototype</strong></p>
<p>Reference to the object from which it inherits non-instance  properties</p>
<p><strong>constructor</strong></p>
<p>Reference to the function object that served as this  object’s constructor</p>
<p><strong>toString()</strong></p>
<p>Converts the object into a string (object-dependent  behavior)</p>
<p><strong>toLocaleString()</strong></p>
<p>Converts the object into a localized string  (object-dependent behavior)</p>
<p><strong>valueOf()</strong></p>
<p>Converts the object into an appropriate primitive type,  usually a number</p>
<p><strong>hasOwnProperty(</strong><strong><em>prop</em></strong><strong>)</strong></p>
<p>Returns <strong>true </strong>if the object has an instance  property named <em>prop</em>, <strong>false  </strong>otherwise</p>
<p><strong>isPrototypeOf(</strong><strong><em>obj</em></strong><strong>)</strong></p>
<p>Returns <strong>true </strong>if the object serves as the  prototype of the object <em>obj</em></p>
<p><strong>propertyIsEnumerable(</strong><strong><em>prop</em></strong><strong>)</strong></p>
<p>Returns <strong>true </strong>if the property given in the  string <em>prop</em>will be enumerated in a <strong>for</strong>/<strong>in</strong>loop</p>
<p>Inheritance in JavaScript is achieved through prototypes. It is clear that  instances of a particular object “inherit” the code and data present in the  constructor’s prototype.</p>

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <footer class="post-footer">
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2009/07/26/kvm-init-debug-debugfs-fops/" rel="next" title="kvm_init_debug debugfs fops">
                <i class="fa fa-chevron-left"></i> kvm_init_debug debugfs fops
              </a>
            
          </div>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2009/08/05/虚拟化及地址空间转换（page-translation-table）/" rel="prev" title="虚拟化及地址空间转换（page translation table）">
                虚拟化及地址空间转换（page translation table） <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          
  <div class="comments" id="comments">
    
  </div>


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap" >
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview sidebar-panel ">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="//schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/wp-content/uploads/penguin.gif"
               alt="jfo" />
          <p class="site-author-name" itemprop="name">jfo</p>
          <p class="site-description motion-element" itemprop="description"></p>
        </div>
        <nav class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="/archives">
              <span class="site-state-item-count">595</span>
              <span class="site-state-item-name">日志</span>
            </a>
          </div>

          
            <div class="site-state-item site-state-categories">
              <a href="/categories">
                <span class="site-state-item-count">36</span>
                <span class="site-state-item-name">分类</span>
              </a>
            </div>
          

          
            <div class="site-state-item site-state-tags">
              <a href="/tags">
                <span class="site-state-item-count">4</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        
          <div class="feed-link motion-element">
            <a href="/atom.xml" rel="alternate">
              <i class="fa fa-rss"></i>
              RSS
            </a>
          </div>
        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/jfojfo" target="_blank" title="GitHub">
                  
                    <i class="fa fa-fw fa-github"></i>
                  
                  GitHub
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://weibo.com/jfojfo" target="_blank" title="微博">
                  
                    <i class="fa fa-fw fa-weibo"></i>
                  
                  微博
                </a>
              </span>
            
          
        </div>

        
        

        
        
          <div class="links-of-blogroll motion-element links-of-blogroll-block">
            <div class="links-of-blogroll-title">
              <i class="fa  fa-fw fa-globe"></i>
              友情链接
            </div>
            <ul class="links-of-blogroll-list">
              
                <li class="links-of-blogroll-item">
                  <a href="http://www.pickbox.me" title="收藏夹" target="_blank">收藏夹</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="http://note.pickbox.me" title="网络剪贴板" target="_blank">网络剪贴板</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="http://iguangba.pickbox.me" title="爱逛吧" target="_blank">爱逛吧</a>
                </li>
              
            </ul>
          </div>
        

      </section>

      
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">
            
              
            
            
              <p class="post-toc-empty">此文章未包含目录</p>
            
          </div>
        </section>
      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2016</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">jfo</span>
</div>

<div class="powered-by">
  由 <a class="theme-link" href="https://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Pisces
  </a>
</div>

        

        
      </div>
    </footer>

    <div class="back-to-top">
      <i class="fa fa-arrow-up"></i>
    </div>
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  



  
  <script type="text/javascript" src="/vendors/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/vendors/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/vendors/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/vendors/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/vendors/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/vendors/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.0.2"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.0.2"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.0.2"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.0.2"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.0.2"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.0.2"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.0.2"></script>



  



  




  
  
  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length == 0) {
       search_path = "search.xml";
    }
    var path = "/" + search_path;
    // monitor main search box;

    function proceedsearch() {
      $("body").append('<div class="popoverlay">').css('overflow', 'hidden');
      $('.popup').toggle();

    }
    // search function;
    var searchFunc = function(path, search_id, content_id) {
    'use strict';
    $.ajax({
        url: path,
        dataType: "xml",
        async: true,
        success: function( xmlResponse ) {
            // get the contents from search data
            isfetched = true;
            $('.popup').detach().appendTo('.header-inner');
            var datas = $( "entry", xmlResponse ).map(function() {
                return {
                    title: $( "title", this ).text(),
                    content: $("content",this).text(),
                    url: $( "url" , this).text()
                };
            }).get();
            var $input = document.getElementById(search_id);
            var $resultContent = document.getElementById(content_id);
            $input.addEventListener('input', function(){
                var matchcounts = 0;
                var str='<ul class=\"search-result-list\">';
                var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
                $resultContent.innerHTML = "";
                if (this.value.trim().length > 1) {
                // perform local searching
                datas.forEach(function(data) {
                    var isMatch = false;
                    var content_index = [];
                    var data_title = data.title.trim().toLowerCase();
                    var data_content = data.content.trim().replace(/<[^>]+>/g,"").toLowerCase();
                    var data_url = data.url;
                    var index_title = -1;
                    var index_content = -1;
                    var first_occur = -1;
                    // only match artiles with not empty titles and contents
                    if(data_title != '') {
                        keywords.forEach(function(keyword, i) {
                            index_title = data_title.indexOf(keyword);
                            index_content = data_content.indexOf(keyword);
                            if( index_title >= 0 || index_content >= 0 ){
                                isMatch = true;
								if (i == 0) {
                                    first_occur = index_content;
                                }
                            } 
							
                        });
                    }
                    // show search results
                    if (isMatch) {
                        matchcounts += 1;
                        str += "<li><a href='"+ data_url +"' class='search-result-title'>"+ data_title +"</a>";
                        var content = data.content.trim().replace(/<[^>]+>/g,"");
                        if (first_occur >= 0) {
                            // cut out 100 characters
                            var start = first_occur - 20;
                            var end = first_occur + 80;
                            if(start < 0){
                                start = 0;
                            }
                            if(start == 0){
                                end = 50;
                            }
                            if(end > content.length){
                                end = content.length;
                            }
                            var match_content = content.substring(start, end);
                            // highlight all keywords
                            keywords.forEach(function(keyword){
                                var regS = new RegExp(keyword, "gi");
                                match_content = match_content.replace(regS, "<b class=\"search-keyword\">"+keyword+"</b>");
                            });

                            str += "<p class=\"search-result\">" + match_content +"...</p>"
                        }
                        str += "</li>";
                    }
                })};
                str += "</ul>";
                if (matchcounts == 0) { str = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>' }
                if (keywords == "") { str = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>' }
                $resultContent.innerHTML = str;
            });
            proceedsearch();
        }
    });}

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched == false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };

    });

    $('.popup-btn-close').click(function(e){
      $('.popup').hide();
      $(".popoverlay").remove();
      $('body').css('overflow', '');
    });
    $('.popup').click(function(e){
      e.stopPropagation();
    });
  </script>


  

  

  

</body>
</html>
