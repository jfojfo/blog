<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <meta http-equiv="X-UA-Compatible" content="IE=edge" >
  <title>jfo planet</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta property="og:type" content="website">
<meta property="og:title" content="jfo planet">
<meta property="og:url" content="http://blog.pickbox.me/page/35/index.html">
<meta property="og:site_name" content="jfo planet">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="jfo planet">
  
    <link rel="alternative" href="/atom.xml" title="jfo planet" type="application/atom+xml">
  
  
    <link rel="icon" href="//favicon.ico">
  
  <script src="/style.js"></script>
  

</head>

<body>
  <div id="container">
    <div class="left-col">
      <div class="overlay"></div>
<div class="intrude-less">
	<header id="header" class="inner">
		<a href="/" class="profilepic">
			
			<img src="http://img.pickbox.me/wp-content/uploads/penguin.gif" class="js-avatar">
			
		</a>

		<hgroup>
		  <h1 class="header-author"><a href="/">jfo</a></h1>
		</hgroup>

		
		<p class="header-subtitle">Hope is the best gift that tomorrow gives.</p>
		

		<nav class="header-menu">
			<ul>
			
				<li><a href="/">主页</a></li>
	        
			</ul>
		</nav>
		<nav class="header-smart-menu">
	        
    		
    			
    			<a class="js-smart-menu" data-idx="0" href="javascript:void(0)">所有文章</a>
    			
    			
            
    			
    			<a class="js-smart-menu" data-idx="1" href="javascript:void(0)">分类</a>
    			
    			
            
    			
    			<a class="js-smart-menu" data-idx="2" href="javascript:void(0)">友链</a>
    			
    			
            
    			
    			<a class="js-smart-menu" data-idx="3" href="javascript:void(0)">关于我</a>
    			
    			
            
		</nav>
		<nav class="header-nav">
			<div class="social">
				
					<a class="github" target="_blank" href="https://github.com/jfojfo" title="github">github</a>
		        
					<a class="zhihu" target="_blank" href="https://www.zhihu.com/people/jfojfo" title="zhihu">zhihu</a>
		        
			</div>
		</nav>
	</header>		
</div>

    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
  	<div class="overlay">
  		<div class="slider-trigger"><i class="icon-list"></i></div>
  		<h1 class="header-author js-mobile-header hide">jfo</h1>
  	</div>
	<div class="intrude-less">
		<header id="header" class="inner">
			<div class="profilepic">
				
					<img src="http://img.pickbox.me/wp-content/uploads/penguin.gif" class="js-avatar">
				
			</div>
			<hgroup>
			  <h1 class="header-author">jfo</h1>
			</hgroup>
			
			<p class="header-subtitle">Hope is the best gift that tomorrow gives.</p>
			
			<nav class="header-menu">
				<ul>
				
					<li><a href="/">主页</a></li>
		        
				</ul>
			</nav>
			<nav class="header-nav">
				<div class="social">
					
						<a class="github" target="_blank" href="https://github.com/jfojfo" title="github">github</a>
			        
						<a class="zhihu" target="_blank" href="https://www.zhihu.com/people/jfojfo" title="zhihu">zhihu</a>
			        
				</div>
			</nav>
		</header>				
	</div>
</nav>

      <div class="body-wrap">
        
  
    <article id="post-C-各大有名GUI库" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2008/09/27/C-各大有名GUI库/">C++各大有名GUI库</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p> C++各大有名库的介绍&mdash;&mdash;GUI　　在众多C++的库中，GUI部分的库算是比较繁荣，也比较引人注目的。在实际开发中，GUI库的选择也是非常重要的一件事情，下面我们综述一下可选择的GUI库，各自的特点以及相关工具的支持。<br><br>1、MFC<br><br>大名鼎鼎的微软基础类库（Microsoft Foundation Class）。大凡学过VC++的人都应该知道这个库。虽然从技术角度讲，MFC是不大漂亮的，但是它构建于Windows API 之上，能够使程序员的工作更容易,编程效率高，减少了大量在建立 Windows 程序时必须编写的代码，同时它还提供了所有一般 C++ 编程的优点，例如继承和封装。MFC 编写的程序在各个版本的Windows操作系统上是可移植的，例如，在Windows 3.1下编写的代码可以很容易地移植到 Windows NT 或 Windows 95 上。但是在最近发展以及官方支持上日渐势微。<br><br>2、QT<br><br>参考网站：<a target="_blank" href="http://www.trolltech.com/">http://www.trolltech.com</a><br><br>Qt是Trolltech公司的一个多平台的C++图形用户界面应用程序框架。它提供给应用程序开发者建立艺术级的图形用户界面所需的所用功能。Qt 是完全面向对象的很容易扩展，并且允许真正地组件编程。自从1996年早些时候，Qt进入商业领域，它已经成为全世界范围内数千种成功的应用程序的基础。 Qt也是流行的Linux桌面环境KDE 的基础，同时它还支持Windows、Macintosh、Unix/X11等多种平台。<br><br>3、WxWindows<br><br>参考网站：<a target="_blank" href="http://www.wxwindows.org/">http://www.wxwindows.org</a><br><br>跨平台的GUI库。因为其类层次极像MFC，所以有文章介绍从MFC到WxWindows的代码移植以实现跨平台的功能。通过多年的开发也是一个日趋 完善的GUI库，支持同样不弱于前面两个库。并且是完全开放源代码的。新近的C++ Builder X的GUI设计器就是基于这个库的。<br><br>4、Fox<br><br>参考网站：<a target="_blank" href="http://www.fox-toolkit.org/">http://www.fox-toolkit.org/</a><br><br>开放源代码的GUI库。作者从自己亲身的开发经验中得出了一个理想的GUI库应该是什么样子的感受出发，从而开始了对这个库的开发。有兴趣的可以尝试一下。<br><br>5、WTL<br><br>基于ATL的一个库。因为使用了大量ATL的轻量级手法，模板等技术，在代码尺寸，以及速度优化方面做得非常到位。主要面向的使用群体是开发COM轻量级供网络下载的可视化控件的开发者。<br><br>6、GTK<br><br>参考网站：<a target="_blank" href="http://gtkmm.sourceforge.net/">http://gtkmm.sourceforge.net/</a><br><br>GTK是一个大名鼎鼎的C的开源GUI库。在Linux世界中有Gnome这样的杀手应用。而Qt就是这个库的C++封装版本。 </p>

      
    </div>
    <div class="article-info article-info-index">
      
      <a href="/2008/09/27/C-各大有名GUI库/" class="archive-article-date">
  	<time datetime="2008-09-27T07:45:00.000Z" itemprop="datePublished"><i class="icon-clock"></i>2008-09-27</time>
</a>
      
      
	<div class="article-category tagcloud">
	<i class="icon-price-tags"></i>
	<a class="article-category-link" href="/categories/c-c-algorithm/">c/c++/algorithm</a>
	</div>


      <div class="clearfix"></div>
    </div>
  </div>
</article>










  
    <article id="post-【zz】Enforcing-Code-Feature-Requirements-in-C" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2008/09/25/【zz】Enforcing-Code-Feature-Requirements-in-C/">【zz】Enforcing Code Feature Requirements in C++</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p> <br><a target="_blank" href="http://www.artima.com/cppsource/codefeatures.html">http://www.artima.com/cppsource/codefeatures.html</a><br><a href="http://docs.google.com/Doc?id=dnc5d3v_109gmz4xwgb" target="_blank">http://docs.google.com/Doc?id=dnc5d3v_109gmz4xwgb</a><br><br>Enforcing Code Feature Requirements in C++by Scott Meyers<br>September 23, 2008SummaryFunctions often depend on particular behavioral characteristics (&ldquo;features&rdquo;) of code they invoke. For example, thread-safe code must invoke only thread-safe code if it is to remain thread-safe, and exception-safe code must invoke only exception-safe code. This paper describes a technique that enables the specification of arbitrary combinations of user-defined code features on a per-function basis and that detects violations of feature constraints during compilation. The technique applies to member functions (both nonvirtual and virtual), non-member functions, and function templates; operators are excluded.<br>Introduction</p><p>When inside a <code>const</code> member function in C++, calls to other member functions on the same object may be made only if those functions are also <code>const</code>. The sole exception to this is when a cast is employed at the call site, i.e., when the <code>const</code>ness of <code><em>this</em></code> is cast away. We can view the <code>const</code>ness of <code>const</code> member functions as a <em>code feature</em>, and we can view the rule that prohibits <code>const</code> member functions from calling non-<code>const</code> member functions as a <em>constraint</em>. Constraints prevent code dependent on a feature from invoking code lacking that feature.</p><p>The constraint involving <code>const</code> is enforced by C++ compilers, but it is easy to imagine useful code features that are not automatically checked:</p><ul> <li><strong>Thread-safe</strong> code should be allowed to call only other thread-safe code. Otherwise the result would not be guaranteed to be thread-safe.</li> <li><strong>Exception-safe</strong> code should be allowed to call only other exception-safe code. Otherwise the result would not be guaranteed to be exception-safe.</li> <li><strong>Portable code</strong> should be allowed to call only other portable code. Otherwise the code base would not be guaranteed to be portable.</li></ul><p>It would be convenient to be able to specify arbitrary code features and have the resulting constraints verified during compilation. This paper describes how that can be achieved in C++.</p><p>C++’s enforcement of the constraint on <code>const</code> member functions actually has nothing to do with functions. <code>const</code> functions are simply member functions where the implicit <code>this</code> object is declared <code>const</code>. What C++ compilers enforce is the rule prohibiting implicit conversion from <code>const T<em></em></code> (pointer to <code>const</code> object) to <code>T</code> (pointer to non-const object). <code>const</code> member functions are based on the <code>const</code>ness of <em>objects</em>, not functions. Nevertheless, their behavior provides a motivation for the development of a way to specify and enforce arbitrary user-defined code feature constraints.</p>Creating code features<p>Code features can be created by defining empty &ldquo;tag&rdquo; structs, analogous to the structs used in the standard C++ library to represent STL iterator categories.<sup><a href="http://www.artima.com/cppsource/codefeatures4.html#refs" target="_blank" rel="external">17</a></sup> Structs representing features are known as <em>feature classes</em>, analogous to the term <em>traits classes</em> for structs representing traits.<sup><a href="http://www.artima.com/cppsource/codefeatures4.html#refs" target="_blank" rel="external">9</a>,<a href="http://www.artima.com/cppsource/codefeatures4.html#refs" target="_blank" rel="external">17</a></sup> Here are some example feature classes:</p>struct ThreadSafe {};<br>struct ExceptionSafe {};<br>struct Portable {};<p>Like those for STL iterator categories, these structs serve only as identifiers. They have no semantics. The meaning of &ldquo;ThreadSafe&rdquo; and &ldquo;Portable&rdquo; (as well as the enforcement of those meanings, i.e., ensuring that the behavior of a function’s code is consistent with the features it claims to offer) is entirely up to programmers.</p><p>Combinations of features can be represented by compile-time collections of feature classes, i.e., collections of types. Such collections are easy to create using the MPL library<sup><a href="http://www.artima.com/cppsource/codefeatures4.html#refs" target="_blank" rel="external">1</a>,<a href="http://www.artima.com/cppsource/codefeatures4.html#refs" target="_blank" rel="external">10</a></sup> for template metaprogramming available at Boost.<sup><a href="http://www.artima.com/cppsource/codefeatures4.html#refs" target="_blank" rel="external">7</a></sup> The MPL (&ldquo;Metaprogramming Library&rdquo;) offers STL-like containers, iterators, and algorithms for working with compile-time information, including types. Code to create a compile-time <code>vector</code>-like container named <code>TESafe</code> that holds the types <code>ThreadSafe</code> and <code>ExceptionSafe</code>, for example, looks like this:</p>typedef boost::mpl::vector&lt;ThreadSafe, ExceptionSafe&gt; TESafe;<p>In principle, the proper container for code features is a set, because it makes no sense for a function to offer a feature more than once. The MPL includes a <code>set</code> container, but in Boost version 1.34 (the release current at the time this research was performed), bugs in <code>mpl::set</code>‘s implementation rendered it unusable for this project. The implementation shown here relies on <code>mpl::vector</code>s instead.</p><p>C++ macros can be used to offer clients an easy way to create both feature classes and an MPL container holding all such classes; the  &ldquo;_n&rdquo; suffix on each macro name indicates how many features are in the universal set. For example,</p>CREATE_CODE_FEATURES_4(ThreadSafe, ExceptionSafe, Portable, Reviewed);<p>defines the feature classes <code>ThreadSafe</code>, <code>ExceptionSafe</code>, <code>Portable</code>, and <code>Reviewed</code>, and it also defines an MPL container, <code>AllCodeFeatures</code>, containing each of these types.</p>Feature constraints and nonvirtual functions<p>Nonvirtual functions (including non-member functions) document the features they offer through a parameter of type <code>MakeFeatures&lt;<em>FeatureContainer</em>&gt;::type</code>. <code>MakeFeatures</code> is a struct template that acts as a <em>metafunction</em>: a function that executes during compilation. Its result&mdash;a type&mdash; is accessed via the nested <code>type</code> typedef. <code> MakeFeatures&lt;<em>FeatureContainer</em>&gt;::type</code> thus refers to the type computed by <code>MakeFeatures</code> given an MPL container of types. This type, which we will examine in detail later, corresponds to a set of code features, so we will refer to it as a <em>feature set type</em> and to objects of such types as <em>feature sets</em>.</p><p>By convention, functions put their feature set parameter at the end of their parameter list. A function <code>f</code> taking parameters of type <code>int</code> and <code>double</code> and offering the <code>ThreadSafe</code> and <code>ExceptionSafe</code> features (i.e., the features in the container <code>TESafe</code>) would be defined this way:</p>void f(int x, double y, MakeFeatures&lt;TESafe&gt;::type features)<br>{ <br>   …     // normal function body<br>}<p>The feature set parameter serves an unconventional role, because it’s not used at runtime. During compilation, however, it specifies the features that <code>f</code> supports and it participates in ensuring that calls to <code>f</code> requiring unsupported features are rejected.</p><p>When invoking a function taking a feature set parameter, the calling function passes an object corresponding to the features it requires. Often, this is the same object it has in its parameter list. For example, consider the following function <code>g</code>, which offers a larger set of code features than <code>f</code>,</p>typedef boost::mpl::vector&lt;ThreadSafe, ExceptionSafe, Portable&gt; TEPSafe;<br><br>void g(MakeFeatures&lt;TEPSafe&gt;::type features); // g offers/requires thread-safe, <br>                                              // exception-safe, and portable code<p>and a call from <code>f</code> to <code>g</code>:</p>void f(int x, double y, MakeFeatures&lt;TESafe&gt;::type features)<br>{ <br>  …<br>  g(features);                                // fine, g offers the features f needs<br>  …  <br>}<p>The reverse call&mdash;from <code>g</code> to <code>f</code>&mdash;will not compile, because <code>g</code> requires the <code>Portable</code> code feature, but <code>f</code> does not offer it:</p>void g(MakeFeatures&lt;TEPSafe&gt;::type features)<br>{<br>  int xVal, yVal;<br>  …<br>  f(xVal, yVal, features);                    // error! f doesn’t offer the Portable feature<br>  …<br>}<p>The compilation failure is due to the lack of a conversion from  <code>MakeFeatures&lt;TEPSafe&gt;::type</code> to <code>MakeFeatures&lt;TESafe&gt;::type</code>, a problem different compilers report in different ways&mdash;some more comprehensible than others. Figures 1 and 2 show the results of submitting the above code to g++ 4.1.1 and Visual C++ 9, respectively. Neither diagnostic is a paragon of clarity, but both identify type conversion as the fundamental problem.</p>articlecode.cpp: In function ‘void g( <br>        CodeFeatures::Features&lt; <br>            boost::mpl::v_item&lt;<br>                CodeFeatures::Portable <br>              , boost::mpl::v_item&lt; <br>                    CodeFeatures::ExceptionSafe <br>                  , boost::mpl::v<em>item&lt; <br>                        CodeFeatures::ThreadSafe, boost::mpl::vector0&lt;mpl</em>::na&gt;<br>                        , 0 <br>                    &gt;, 0 <br>                &gt;, 0 <br>            &gt; <br>        &gt; <br>    )’: <br>articlecode.cpp:32: error: conversion from ‘CodeFeatures::Features&lt;<br>        boost::mpl::v_item&lt; <br>            CodeFeatures::Portable <br>          , boost::mpl::v_item&lt; <br>                CodeFeatures::ExceptionSafe <br>              , boost::mpl::v<em>item&lt; <br>                    CodeFeatures::ThreadSafe, boost::mpl::vector0&lt;mpl</em>::na&gt;, 0 <br>                &gt;, 0 <br>            &gt;, 0 <br>        &gt; <br>    &gt;’ to non-scalar type ‘CodeFeatures::Features&lt;<br>        boost::mpl::v_item&lt;<br>            CodeFeatures::ExceptionSafe <br>          , boost::mpl::v<em>item&lt; <br>                CodeFeatures::ThreadSafe, boost::mpl::vector0&lt;mpl</em>::na&gt;, 0 <br>            &lt;, 0 <br>        &gt; <br>    &gt;’ requested<p><strong> Figure 1: Diagnostic from g++ for a violated code feature constraint. </strong></p>articlecode.cpp(32) : error C2664: ‘f’ : cannot convert parameter 3 from <br>‘CodeFeatures::Features&lt;S&gt;’ to ‘CodeFeatures::Features&lt;S&gt;’ <br>        with <br>        [ <br>            S=boost::mpl::vector3&lt;CodeFeatures::ThreadSafe,CodeFeatures::ExceptionSafe,CodeFeatures::Portable&gt; <br>        ] <br>        and <br>        [ <br>            S=boost::mpl::vector2&lt;CodeFeatures::ThreadSafe,CodeFeatures::ExceptionSafe&gt;<br>        ] <br>        No user-defined-conversion operator available that can perform this conversion, or the operator cannot be called<p><strong> Figure 2: Diagnostic from Visual C++ for a violated code feature constraint. </strong></p><p>Functions lacking <code>MakeFeatures</code> parameters can call functions that have them by creating the appropriate object prior to or at the point of the call:</p>void h()                                                // h has no feature set parameter<br>{<br>  typedef mpl::container&lt;…&gt; NeededFeatures;           // define features needed by h<br>  int xVal, yVal;<br>  …<br>  f(xVal, yVal, MakeFeatures&lt;NeededFeatures&gt;::type());  // create anonymous feature set<br>  …                                                   // object; call to f succeeds if all<br>                                                        // features in NeededFeatures<br>}                                                       // are in TESafe<br>Relaxing feature constraints<p>Callers will occasionally wish to explicitly relax constraints for a call. For example, a thread-safe function may wish to call another function not guaranteed to be thread-safe, because the call is made in a context where the thread-safety of the called function is not of concern (e.g., while holding a lock on all data accessed by the called function). There are two ways to relax feature constraints for a call. The easiest is to pass an object of type <code>IgnoreFeatures</code> as the feature set object. That causes all feature constraints to be ignored, i.e., to treat the call as if the calling function had no feature requirements:</p>void g(MakeFeatures&lt;TEPSafe&gt;::type features)  // as before <br>{<br>  int xVal, yVal;<br>  …<br>  f(xVal, yVal, IgnoreFeatures());            // fine, g’s feature requirements are<br>  …                                         // ignored<br>}<p><code>IgnoreFeatures</code> itself is simply a typedef for a feature set type created from an empty container of features:</p>typedef MakeFeatures&lt; mpl::vector&lt;&gt; &gt;::type IgnoreFeatures;<p>The second way to relax feature constraints for a call is to create a new feature container with fewer features than the calling function usually requires. This is generally accomplished by erasing features from the function’s <code>MakeFeatures</code> parameter and naming the result. The MPL supports only functional constructs, so there is no way to modify the contents of an MPL container after the container has been created. Erasing a type from an MPL container yields a new container; the original is unchanged. To eliminate only the <code>Portable</code> requirement in the call from <code>g</code> to <code>f</code>, the following code can be used:</p>void g(MakeFeatures&lt;TEPSafe&gt;::type features)             // as before <br>{<br>  …<br>  typedef eraseVal&lt;TEPSafe, Portable&gt;::type              // remove Portable from<br>          RevisedFeatures;                               // TEPSafe and name the<br>                                                         // result &ldquo;RevisedFeatures&rdquo;<br><br>  f( xVal, yVal, MakeFeatures&lt;RevisedFeatures&gt;::type()); // call f with RevisedFeatures<br>  …<br>}<p>The MPL has no <code>eraseVal</code> metafunction, but it’s easy to write, based on other MPL and Boost functionality:</p>template&lt;typename Seq, typename T&gt; // code explanation is below<br>struct eraseVal<br>: mpl::copy<em>if&lt;Seq, mpl::not</em>&lt;boost::is_same&lt;_1,T&gt; &gt; &gt;<br>{};<p>Conceptually, this code says &ldquo;<code>eraseVal</code> takes a type sequence <code>Seq</code> (e.g., an <code>mpl::vector</code>) and a type <code>T</code>, and it creates a new sequence by copying every type in <code>Seq</code> that is not the same as <code>T</code>.&rdquo; Details on the syntax and semantics of the MPL are beyond the scope of this paper; interested readers are encouraged to consult the MPL documentation.<sup><a href="http://www.artima.com/cppsource/codefeatures4.html#refs" target="_blank" rel="external">1</a>,<a href="http://www.artima.com/cppsource/codefeatures4.html#refs" target="_blank" rel="external">10</a></sup></p>Enforcing feature set constraints<p>Compile-time enforcement of feature requirements is based on the observation that in a call from a function requiring features to a function offering features, there are two feature set objects: the caller’s (the argument passed) and the callee’s (the formal parameter). The type of the caller’s object is <code>MakeFeatures&lt;<em>NeededFeatures</em>&gt;::type</code>, while the type of the callee’s is <code>MakeFeatures&lt;<em>OfferedFeatures</em>&gt;::type</code>. If these are the same type, the type needed and the type offered are identical, and the call succeeds. If they are not the same type, the call should succeed only if all the types in <code><em>NeededFeatures</em></code> are present in <code><em>OfferedFeatures</em></code>. But if <code>MakeFeatures&lt;<em>NeededFeatures</em>&gt;::type</code> (i.e., <em><code>T<sub>needed</sub></code></em>) and <code>MakeFeatures&lt;<em>OfferedFeatures</em>&gt;::type</code> (<em><code>T<sub>offered</sub></code></em>) are different types, C++ specifies that the call is valid only if there is an implicit conversion from <em><code>T<sub>needed</sub></code></em> to <em><code>T<sub>offered</sub></code></em>. The challenge is to design things so that only the appropriate conversions are available.</p><p>A complicating factor is that functions may be overloaded on their feature set types. Consider two declarations for an overloaded function <code>g</code>:</p>typedef boost::mpl::vector&lt;ThreadSafe, ExceptionSafe&gt; TESafe;             // as before<br>typedef boost::mpl::vector&lt;ThreadSafe, ExceptionSafe, Portable&gt; TEPSafe;  // as before<br><br>void g(<em>parameters</em>, MakeFeatures&lt;TESafe&gt;::type);   // call this function g<em><sub>TE</sub></em><br><br>void g(<em>parameters</em>, MakeFeatures&lt;TEPSafe&gt;::type);  // call this function g<em><sub>TEP</sub></em><p>Consider also a function <code>f1</code> that requires only portability and that calls <code>g</code>:</p>typedef boost::mpl::vector&lt;Portable&gt; PSafe;<br>void f1(<em>parameters</em>, MakeFeatures&lt;PSafe&gt;::type features)<br>{<br>  …<br>  g(<em>parameters</em>, features);  <br>  …<br>}<p>This should unambiguously call <code>g<sub>TEP</sub></code> (the version of <code>g</code> whose feature set is based on <code>TEPSafe</code>), i.e., that includes the <code>Portable</code> feature. In general, there should be an implicit conversion from <code>T<sub><em>needed</em></sub></code> to <code>T<sub><em>offered</em></sub></code> if and only if all the features used to build <code>T<sub><em>needed</em></sub></code> are also present in <code>T<sub><em>offered</em></sub></code>.</p><p>Consider now a function <code>f2</code> that requires only thread safety and that calls <code>g</code>:</p>typedef boost::mpl::vector&lt;ThreadSafe&gt; TSafe;<br>void f2(<em>parameters</em>, MakeFeatures&lt;TSafe&gt;::type features)<br>{<br>  …<br>  g(<em>parameters</em>, features);  <br>  …<br>}<p>Both versions of <code>g</code> satisfy <code>f2</code>‘s requirements, so it would seem that the call is ambiguous. However, <code>g<sub>TEP</sub></code> offers more unnecessary features than <code>g<sub>TE</sub></code>, and the ambiguity would be avoided if we preferred fewer unnecessary features to more. If we assume that offering code features (i.e., imposing constraints on function implementers) may incur a runtime cost, it seems desirable to avoid imposing such costs on callers when we do not have to. The policy, therefore, is to prefer conversions among feature set types that add as few unnecessary features as possible. This policy dictates that in the call from <code>f2</code> to <code>g</code> above, <code>g<sub>TE</sub></code>  should be unambiguously selected as the target function.</p><p>Conversions among feature set types should thus obey these two rules:</p><ul> <li><code>T<sub><em>needed</em></sub></code> converts to <code>T<sub><em>offered</em></sub></code> only if <code>T<sub><em>offered</em></sub></code> has all the features in <code>T<sub><em>needed</em></sub></code>.</li> <li>If <code>T<sub><em>needed</em></sub></code> can be converted to more than one <code>T<sub><em>offered</em></sub></code>, conversions adding fewer features are preferred to those adding more. If conversions exist to more than one <code>T<sub><em>offered</em></sub></code> with the same number of features, the conversion is ambiguous.</li></ul><p>The behavior dictated by these rules can be achieved by use of an inheritance hierarchy, where each class in the hierarchy is a feature set type.</p><p><img src="http://img.pickbox.me/wp-content/uploads/pic/other_site/www_artima_codeFeatures1.gif" alt="Inheritance hierarchy for feature sets"></p>Figure 3: Inheritance hierarchy for feature sets comprised of features A, B, C, and D.  All inheritance  links are virtual. Highlighted parts of the figure are those needed for the feature set <code>{B,C}</code>.<p>Figure 3 shows the hierarchy for combinations of up to four features, where the features are named <code>A</code>, <code>B</code>, <code>C</code>, and <code>D</code>. The structure of the hierarchy makes clear that implicit conversions may only add features (i.e., no conversion exists if a caller requests more features than a callee offers) and that conversions adding fewer features are preferred over conversions adding more. To prevent ambiguity when more than one inheritance path leads from the source to the target of an allowed conversion, all inheritance links are virtual. This makes it possible, for example, for a caller requiring only feature <code>B</code> to unambiguously invoke a callee offering features <code>A</code>,  <code>B</code>, and <code>C</code>, even though there is more than one inheritance path from the class for <code>{B}</code> to the class for <code>{A,B,C}</code>.</p><p>The central difficulty in compile-time feature constraint enforcement is implementing the <code>MakeFeatures</code> template such that a suitable inheritance hierarchy is automatically generated and that <code>MakeFeatures&lt;<em>Features</em>&gt;::type</code> is the appropriate class in that hierarchy. In general, a hierarchy such as shown in Figure 3 need not be generated in full. Rather, only the part of the hierarchy corresponding to <em>Features</em> and its supersets need be created. Figure 3 highlights the portion of the hierarchy that must be generated to support the conversions applicable to the feature set <code>{B,C}</code>.</p><p>The implementation, which is heavily based on code posted by Watanabe,<sup><a href="http://www.artima.com/cppsource/codefeatures4.html#refs" target="_blank" rel="external">21</a></sup> is shown in Listings 1 and 2. Readers unfamiliar with the MPL are again encouraged to consult the library’s documentation for details on its syntax and semantics. What follows is an overview of the implementation, the goal being to convey the essence of the approach employed.</p>1 namespace CodeFeatures { <br>2   namespace mpl = boost::mpl; <br>3   using mpl::_1; <br>4   using mpl::_2; <br><br>5   template&lt;typename S, typename T&gt; <br>6   struct IndexOf: <br>7     mpl::distance&lt;typename mpl::begin&lt;S&gt;::type, <br>8                   typename mpl::find&lt;S, T&gt;::type&gt; <br>9   {}; <br><br>10   template&lt;typename Unordered&gt; <br>11   struct Order: <br>12     mpl::sort&lt;Unordered, <br>13               mpl::less&lt;IndexOf&lt;AllCodeFeatures, _1&gt;, <br>14                         IndexOf&lt;AllCodeFeatures, _2&gt; &gt; &gt; <br>15   {}; <br><br>16   template&lt;typename CF&gt; <br>17   struct MakeFeatures { <br>18     typedef <br>19       Features&lt;typename mpl::copy&lt;typename Order&lt;CF&gt;::type, <br>20                                   mpl::back_inserter&lt;mpl::vector0&lt;&gt; &gt; &gt;::type&gt; <br>21       type; <br>22   }; <br><br>23 }<p><strong> Listing 1: Implementation of <code>MakeFeatures</code>. </strong></p><p>The <code>MakeFeatures</code> metafunction itself is defined in lines 16-22 of Listing 1. Its parameter, <code>CF</code>, is an MPL collection of feature classes. The MPL supports several types of collections, including <code>vector</code>, <code>list</code>, and <code>set</code>, but parts of the code used to enforce feature constraints are applicable only to <code>vector</code> and <code>deque</code>, so lines 19-20 use <code>mpl::copy</code> to copy the feature classes in <code>CF</code> into a <code>vector</code>. Prior to the copy, the feature classes are put into a canonical order (via the call to <code>Order</code> on line 19) so that all permutations of feature classes corresponding to the same set of features are represented by a single type in the hierarchy. (Hence, <code>MakeFeatures&lt;mpl::vector&lt;A,B&gt; &gt;::type</code> and <code>MakeFeatures&lt;mpl::vector&lt;B,A&gt; &gt;::type</code> yield the same type.) The code to perform the ordering is on lines 10-15 and 5-9 (the latter being invoked by the former via the call to <code>mpl::sort</code> on lines 12-14).</p>1 namespace CodeFeatures { <br>2   namespace mpl = boost::mpl; <br>3   using mpl::_1; <br>4   using mpl::<em>2; <br>5   using mpl::</em>; <br><br>6   template&lt;typename Base1, typename Base2&gt;<br>7   struct VirtualInherit : virtual Base1, virtual Base2 {}; <br><br>8   template&lt;typename S&gt; <br>9   struct MakeFeatures; <br><br>10   template&lt;typename S1, typename S2&gt; <br>11   struct Difference: <br>12     mpl::remove<em>if&lt;S1, mpl::contains&lt;S2, </em> &gt; &gt;<br>13   {}; <br><br>14   template&lt;typename Present, typename Omitted&gt; <br>15   struct GetFeaturesBases: <br>16     mpl::transform&lt;Omitted, MakeFeatures&lt;mpl::push<em>back&lt;Present, </em>&gt; &gt; &gt; <br>17   {}; <br><br>18   template&lt;typename S&gt; <br>19   struct Features: <br>20     virtual mpl::fold&lt; <br>21       typename GetFeaturesBases&lt;S, <br>22                                 typename Difference&lt;AllCodeFeatures, S&gt;::type <br>23                                &gt;::type, <br>24       mpl::empty<em>base, <br>25       VirtualInherit&lt;</em>, _&gt; <br>26     &gt;::type <br>27  {}; <br><br>28 }<p><strong> Listing 2: Implementation of <code>Features</code>. </strong></p><p>The type returned by <code>MakeFeatures</code> is an instantiation of the <code>Features</code> template, which is defined on lines 18-27 of Listing 2. Behaviorally, <code>Features</code> instantiations correspond to the classes in Figure 3. Each <code>Features</code> class virtually inherits (line 20) from <code>mpl::fold&lt;…&gt;::type</code>, which is a typedef for an instantiation of <code>VirtualInherit</code>, a template defined on lines 6-7. <code>VirtualInherit</code> itself inherits from two bases, so the local hierarchy around each <code>Features</code> instantiation is as shown in Figure 4.</p><p><img src="http://img.pickbox.me/wp-content/uploads/pic/other_site/www_artima_codeFeatures2.gif" alt="Local inheritance structure"></p><p><strong> Figure 4: Local inheritance structure of <code>Features</code> instantiations. </strong></p>As this figure suggests, no class in the hierarchy generated by <code>MakeFeatures</code> has more than two base classes, and that means <code>MakeFeatures</code>-generated hierarchies cannot have the structure depicted in Figure 3. For type conversion purposes, however, they can act as if they did, because inheriting from three base classes <code>B1</code>, <code>B2</code>, and <code>B3</code> is behaviorally the same as inheriting from two base classes: <code>B1</code> and <code>VirtualInherit&lt;B2,B3&gt;</code>.<p>The actual hierarchy generated from the code in Listing 2 for inheritance from <code>B1</code>, <code>B2</code>, and <code>B3</code> is somewhat more complicated than this, but the insight that direct inheritance from an arbitrary number of base classes can be emulated by indirect inheritance from hierarchy of intermediate classes like <code>VirtualInherit</code> is the key to understanding how a hierarchy using no more than two base classes per class can, for purposes of implicit type conversion, behave like a hierarchy where classes have a greater number of bases.</p><p><code>Features&lt;S&gt;</code> is the type in the hierarchy representing the set of feature classes in <code>S</code>. The hierarchy above it is generated by <code>mpl::fold</code>, which behaves similarly to the STL <code>accumulate</code> algorithm. <code>mpl::fold</code> takes a sequence of types on which to operate (lines 21-23 of Listing 2), an initial state (<code>mpl::empty_base</code> on line 24), and a binary operator to apply to the current type and the current state (<code>VirtualInherit</code> on line 25). In this case, the result is that <code>mpl::fold</code> iteratively takes a missing feature <code><em>mf</em></code> not in <code>S</code> and adds <code>Features&lt;S+<em>mf</em>&gt;</code> as an (indirect through <code>VirtualInherit</code>) base class. Features&lt;S+<em>mf</em>&gt; then applies <code>mpl::fold</code> again to create the hierarchy above it, and this proceeds recursively until <code>Features</code> classes for all  supersets of the features classes in <code>S</code> have been generated as (indirect) bases of <code>Features&lt;S&gt;</code>.</p><br>Feature constraints and virtual functions<p>Virtual functions introduce a new issue, one arising from the C++ rule that virtual function overrides in derived classes must declare the same parameter types as their base class counterparts. A derived class override may be invoked through a pointer or reference to a base class, so the override must certainly offer the code features promised by the base class function, but there is no reason why a virtual function in a derived class shouldn’t be allowed to offer <em>more</em> features than the corresponding base class function. Unfortunately, straightforward application of the current design fails to allow that:</p>class Base {<br>public:<br>  typedef mpl::vector&lt;ThreadSafe, Reviewed&gt; BaseFeatures; <br>  virtual void vf(int x, std::string&amp; s, MakeFeatures&lt;BaseFeatures&gt;::type features);<br>  …<br>}; <br><br>class Derived: public Base {<br>public:<br>  typedef mpl::vector&lt;ThreadSafe, Reviewed, Portable&gt; DerFeatures;                  // note revised  <br>                                                                                    // def’n compared<br>                                                                                    // to base class<br><br>  virtual void vf(int x, std::string&amp; s, MakeFeatures&lt;DerFeatures&gt;::type features); // doesn’t override <br>  …                                                                               // Base::vf!<br>};<p>What’s needed is a way for derived classes to satisfy C++’s rule that virtual overrides have the same parameter types as their base class counterparts yet also advertise implementations offering additional code features. (Interestingly, this problem would vanish if C++ allowed contravariant parameter types, because <code>MakeFeatures&lt;BaseFeatures&gt;::type</code> (the base class function’s feature set) inherits from <code>MakeFeatures&lt;DerFeatures&gt;::type</code> (the derived class function’s feature set).)</p><p>Overloading provides an effective solution to this problem. The derived class declares two functions with the same name, one using the same feature set type as the base class, the other using the enhanced feature set the derived class wishes to offer. The implementation of the base class override consists of a simple inline call to the enhanced function. Class <code>Derived</code> above would thus be implemented like this:</p>class Derived: public Base {<br>public:<br>  typedef mpl::vector&lt;ThreadSafe, Reviewed, Portable&gt; DerFeatures;   // as before<br><br>  virtual void vf(int x, std::string&amp; s,                             // override base<br>                  MakeFeatures&lt;BaseFeatures&gt;::type features)         // virtual function  <br>  {                                                                       <br>     // verify feature contravariance<br>     typedef MakeFeatures&lt;BaseFeatures&gt;::type BaseFeaturesClass; <br>     typedef MakeFeatures&lt;DerFeatures&gt;::type DerFeaturesClass; <br>     BOOST_MPL_ASSERT((boost::is_base_of&lt;DerFeaturesClass,BaseFeaturesClass&gt;)); <br><br>     return vf(x, s, MakeFeatures&lt;DerFeatures&gt;::type());             // inline call to<br>  }                                                                  // enhanced function<br><br>  virtual void vf(int x, std::string&amp; s,                             // as before<br>                  MakeFeatures&lt;DerFeatures&gt;::type features);  <br><br>  …                          <br>};<p>This design offers callers invoking virtual functions through a base class interface the code features advertised by that interface while also allowing callers aware of the derived interface to take advantage of the additional code features provided by the derived class. It is thus analogous to C++’s support for covariant return types on virtual functions.<sup><a href="http://www.artima.com/cppsource/codefeatures4.html#refs" target="_blank" rel="external">12</a></sup></p>Performance<p>In principle, feature checking incurs no runtime cost, because everything happens during compilation. Each feature set parameter, however, could lead to a runtime argument being passed from caller to callee, even though the argument would go unused. Whether this occurs depends on the optimization settings and capabilities of the C++ compiler. If such objects are not optimized away, Table 1 demonstrates that their size could be significant (up to many thousands of bytes per feature set), an artifact of the use of virtual inheritance<sup><a href="http://www.artima.com/cppsource/codefeatures4.html#refs" target="_blank" rel="external">14</a></sup> in the current implementation.</p><p>C++ template metaprogramming has a reputation for causing significant increases in compilation times, and my experience is that this reputation is not undeserved. Test programs of a few dozen lines (excluding header contents) often took 30 seconds or longer to compile, and experiments with more than 5 total features were abandoned due to excessively long compilation times or, in the case of Visual C++, aborted compilations due to internal compiler errors.</p><p>The implementation described here was designed only as a proof of concept, however; efficiency was not a concern. It is reasonable to expect that less costly implementations would be devised were that aspect of the problem to become the focus of attention. For example, the current implementation passes feature set parameters by value rather than by pointer or reference-to-<code>const</code>, a decision motivated by the desire to avoid adding unnecessary symbols to the already somewhat cumbersome TMP-based syntax.</p><br><br><br><br><br><br> <p></p>

      
    </div>
    <div class="article-info article-info-index">
      
      <a href="/2008/09/25/【zz】Enforcing-Code-Feature-Requirements-in-C/" class="archive-article-date">
  	<time datetime="2008-09-25T06:45:00.000Z" itemprop="datePublished"><i class="icon-clock"></i>2008-09-25</time>
</a>
      
      
	<div class="article-category tagcloud">
	<i class="icon-price-tags"></i>
	<a class="article-category-link" href="/categories/c-c-template-gp-boost/">c++/c++ template/gp/boost</a>
	</div>


      <div class="clearfix"></div>
    </div>
  </div>
</article>










  
    <article id="post-udev-hal-dbus" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2008/09/19/udev-hal-dbus/">udev - hal - dbus</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p> <br><br><strong>References:</strong><br><br><strong>UDEV</strong>udev f.a.q.             <a href="http://www.kernel.org/pub/linux/utils/kernel/hotplug/udev-FAQ" target="_blank" rel="external">http://www.kernel.org/pub/linux/utils/kernel/hotplug/udev-FAQ</a><br>writing udev rules      <a href="http://www.reactivated.net/writing_udev_rules.html" target="_blank" rel="external">http://www.reactivated.net/writing_udev_rules.html</a><br>good howto              <a href="http://webpages.charter.net/decibelshelp/LinuxHelp_UDEVPrimer.html" target="_blank" rel="external">http://webpages.charter.net/decibelshelp/LinuxHelp_UDEVPrimer.html</a><br>udev实现原理           <a target="_blank" href="http://blog.csdn.net/absurd/archive/2007/04/27/1587938.aspx">http://blog.csdn.net/absurd/archive/2007/04/27/1587938.aspx</a><br>hotplug and firmware loading with sysfs<br> <a target="_blank" href="http://www.kerneltravel.net/jiaoliu/sysfs.txt">http://www.kerneltravel.net/jiaoliu/sysfs.txt</a><br><br><strong>HAL</strong>the purpose of hal      <a href="http://www.ometer.com/hardware.html" target="_blank" rel="external">http://www.ometer.com/hardware.html</a><br>hal web site            <a href="http://freedesktop.org/wiki/Software_2fhal" target="_blank" rel="external">http://freedesktop.org/wiki/Software_2fhal</a><br>Mark discovering hal    <a href="http://www.mythic-beasts.com/%7Emark/random/hal/" target="_blank" rel="external">http://www.mythic-beasts.com/~mark/random/hal/</a><br>Hal specifications      <a href="http://webcvs.freedesktop.org/hal/hal/doc/spec/hal-spec.html?view=co#ov_hal_linux26" target="_blank" rel="external">http://webcvs.freedesktop.org/hal/hal/doc/spec/hal-spec.html?view=co#ov_hal_linux26</a> <br> <a target="_blank" href="http://people.freedesktop.org/~david/hal-spec/hal-spec.html">http://people.freedesktop.org/~david/hal-spec/hal-spec.html</a><br>Linux HAL的工作原理     <a target="_blank" href="http://blog.csdn.net/absurd/archive/2007/05/03/1595625.aspx">http://blog.csdn.net/absurd/archive/2007/05/03/1595625.aspx</a><br><strong>D-BUS</strong>d-bus f.a.q.            <a href="http://dbus.freedesktop.org/doc/dbus-faq.html#id2688224" target="_blank" rel="external">http://dbus.freedesktop.org/doc/dbus-faq.html#id2688224</a><br>d-bus example           <a href="http://www.ibm.com/developerworks/cn/linux/l-dbus.html" target="_blank">http://www.ibm.com/developerworks/cn/linux/l-dbus.html</a><br>d-bus study             <a href="http://blog.csdn.net/yuhang111/archive/2007/08/27/1760141.aspx" target="_blank">http://blog.csdn.net/yuhang111/archive/2007/08/27/1760141.aspx</a> </p>

      
    </div>
    <div class="article-info article-info-index">
      
      <a href="/2008/09/19/udev-hal-dbus/" class="archive-article-date">
  	<time datetime="2008-09-19T07:10:00.000Z" itemprop="datePublished"><i class="icon-clock"></i>2008-09-19</time>
</a>
      
      
	<div class="article-category tagcloud">
	<i class="icon-price-tags"></i>
	<a class="article-category-link" href="/categories/Linux/">Linux</a>
	</div>


      <div class="clearfix"></div>
    </div>
  </div>
</article>










  
    <article id="post-upstart-Ubuntu-s-event-based-init-daemon" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2008/09/19/upstart-Ubuntu-s-event-based-init-daemon/">upstart : Ubuntu&#39;s event-based init daemon</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p> <br>Ubuntu-8.04系统启动过程<br><br>upstart包提供/sbin/init<br>upstart-compat-sysv包提供与sysv兼容的系统启动文件，包括/etc/event.d/{rcS,rc[0-6],rc-default,rc-sulogin}，以及halt、reboot、shutdown等命令。<br><br>ubuntu-8.04中，系统在执行initrd中/init脚本的最后一步，执行<br>exec run-init ${rootmnt} ${init} &quot;$@&quot; &lt;${rootmnt}/dev/console &gt;${rootmnt}/dev/console 2&gt;&amp;1其中run-init是由klibc-utils包（klibc-1.5.7/usr/kinit/run-init/run-init.c）提供的。<br><br>run-init做完必要的设置后，execv(&quot;/sbin/init&quot;, …)，将控制交给upstart，/sbin/init的PID为1。<br><br>upstart的/sbin/init会读取/etc/event.d/目录下的配置文件，并监控该目录的变化，还会emit一个STARTUP_EVENT，之后就进入一个循环。<br>/etc/event.d/目录下的rcS脚本的开头是&quot;start on startup&quot;，STARTUP_EVENT信号的发出使得该脚本响应，其内容如下：<br>start on startup<br>stop on runlevel<br>console output<br>script<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   runlevel –set S &gt;/dev/null || true<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   PREVLEVEL=N<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   RUNLEVEL=S<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   export PREVLEVEL RUNLEVEL<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   exec /etc/init.d/rcS<br>end script<br><br>可以看出，随后/etc/init.d/rcS脚本将继续执行，它将依次执行/etc/rcS.d/下的启动脚本。<br><br>/etc/init.d/rcS执行完毕后，/etc/event.d/rcS也结束，随后/etc/event.d/rc-default将执行（其配置为start on stopped rcS），其内容如下：<br>start on stopped rcS<br>script<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   runlevel –reboot || true<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   if grep -q -w – &quot;-s|single|S&quot; /proc/cmdline; then<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   telinit S<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   elif [ -r /etc/inittab ]; then<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   RL=&quot;$(sed -n -e &quot;/^id:[0-9]<em>:initdefault:/{s/^id://;s/:.</em>//;p}&quot; /etc/inittab || true)&quot;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   if [ -n &quot;$RL&quot; ]; then<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   telinit $RL<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   else<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   telinit 2<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   fi<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   else<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   telinit 2<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   fi<br>end script<br><br>它将进入runlevel 2，并执行/etc/rc2.d/下的脚本。<br><br>至此，系统启动过程全部完成！<br><br><br><br>=================================================================================<br>在event.d/下添加一个新的event响应<br><br><br>ref：<a href="http://www.linux.com/feature/125977" target="_blank">http://www.linux.com/feature/125977</a><br>$ <strong>cat /etc/event.d/myjob </strong><br>start on hithere <br>script <br> echo &quot;Hi there, here I am!&quot; &gt; /tmp/myjob.out<br>  date &gt;&gt; /tmp/myjob.out <br>end script<br>$ <strong>sudo initctl emit hithere</strong><br>hithere <br>myjob (start) waiting <br>myjob (start) starting <br>myjob (start) pre-start <br>myjob (start) spawned, process 6064 <br>myjob (start) post-start, (main) process 6064 <br>myjob (start) running, process 6064 <br>myjob (stop) running <br>myjob (stop) stopping <br>myjob (stop) killed <br>myjob (stop) post-stop <br>myjob (stop) waiting <br><br>$ <strong>cat /tmp/myjob.out </strong><br>Hi there, here I am! <br>Sat Jul 7 20:19:13 PDT 2007<br><br><br><br><br><br><br><br><br><br><del>end</del> </p>

      
    </div>
    <div class="article-info article-info-index">
      
      <a href="/2008/09/19/upstart-Ubuntu-s-event-based-init-daemon/" class="archive-article-date">
  	<time datetime="2008-09-18T16:00:00.000Z" itemprop="datePublished"><i class="icon-clock"></i>2008-09-19</time>
</a>
      
      
	<div class="article-category tagcloud">
	<i class="icon-price-tags"></i>
	<a class="article-category-link" href="/categories/Linux/">Linux</a>
	</div>


      <div class="clearfix"></div>
    </div>
  </div>
</article>










  
    <article id="post-Dual-Display，Ubuntu下为笔记本实现双显示器" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2008/09/16/Dual-Display，Ubuntu下为笔记本实现双显示器/">Dual Display，Ubuntu下为笔记本实现双显示器</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p> ref ： <a href="http://thatssky.spaces.live.com/Blog/cns!251B8640E925FC00!507.entry" target="_blank">http://thatssky.spaces.live.com/Blog/cns!251B8640E925FC00!507.entry</a><br><br>修改/etc/X11/xorg.conf：<br><br>Section &quot;Device&quot;<br>&nbsp;&nbsp;&nbsp;   Identifier&nbsp;&nbsp;&nbsp;   &quot;Configured Video Device&quot;<br>&nbsp;&nbsp;&nbsp;   Driver&nbsp;&nbsp;&nbsp;   &nbsp;&nbsp;&nbsp;   &quot;fglrx&quot;<br>EndSection<br><br># added<br>Section &quot;Device&quot;<br>&nbsp;&nbsp;&nbsp;   Identifier&nbsp;&nbsp;&nbsp;   &quot;Card1&quot;<br>&nbsp;&nbsp;&nbsp;   Driver&nbsp;&nbsp;&nbsp;   &nbsp;&nbsp;&nbsp;   &quot;fglrx&quot;<br>EndSection<br><br>Section &quot;Monitor&quot;<br>&nbsp;&nbsp;&nbsp;   Identifier&nbsp;&nbsp;&nbsp;   &quot;Configured Monitor&quot;<br>EndSection<br><br># added<br>Section &quot;Monitor&quot;<br>&nbsp;&nbsp;&nbsp;   Identifier&nbsp;&nbsp;&nbsp;   &quot;ExtMonitor&quot;<br>EndSection<br><br>Section &quot;Screen&quot;<br>&nbsp;&nbsp;&nbsp;   Identifier&nbsp;&nbsp;&nbsp;   &quot;Default Screen&quot;<br>&nbsp;&nbsp;&nbsp;   Monitor&nbsp;&nbsp;&nbsp;   &nbsp;&nbsp;&nbsp;   &quot;Configured Monitor&quot;<br>&nbsp;&nbsp;&nbsp;   Device&nbsp;&nbsp;&nbsp;   &nbsp;&nbsp;&nbsp;   &quot;Configured Video Device&quot;<br>&nbsp;&nbsp;&nbsp;   Defaultdepth&nbsp;&nbsp;&nbsp;   24<br>EndSection<br><br># added<br>Section &quot;Screen&quot;<br>&nbsp;&nbsp;&nbsp;   Identifier&nbsp;&nbsp;&nbsp;   &quot;Screen1&quot;<br>&nbsp;&nbsp;&nbsp;   Monitor&nbsp;&nbsp;&nbsp;   &nbsp;&nbsp;&nbsp;   &quot;ExtMonitor&quot;<br>&nbsp;&nbsp;&nbsp;   Device&nbsp;&nbsp;&nbsp;   &nbsp;&nbsp;&nbsp;   &quot;Card1&quot;<br>&nbsp;&nbsp;&nbsp;   Defaultdepth&nbsp;&nbsp;&nbsp;   24<br>EndSection<br><br>#Section &quot;ServerLayout&quot;<br>#&nbsp;&nbsp;&nbsp;   Identifier&nbsp;&nbsp;&nbsp;   &quot;Default Layout&quot;<br>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   screen&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   &quot;Default Screen&quot;<br>#&nbsp;&nbsp;&nbsp;   Inputdevice&nbsp;&nbsp;&nbsp;   &quot;Synaptics Touchpad&quot;<br>#EndSection<br><br># added<br>Section &quot;ServerLayout&quot;<br>&nbsp;&nbsp;&nbsp;   Identifier&nbsp;&nbsp;&nbsp;   &quot;DualHead&quot;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   screen&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   &quot;Default Screen&quot; 0 0<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   screen&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   &quot;Screen1&quot; RightOf &quot;Default Screen&quot;<br>&nbsp;&nbsp;&nbsp;   Inputdevice&nbsp;&nbsp;&nbsp;   &quot;Synaptics Touchpad&quot;<br>EndSection<br><br>＃如果只是扩展屏幕，也就是窗口可以拖到另外一个屏幕，就加上下面这段；如果需要两个独立的显示就去掉。<br># added<br>Section &quot;ServerFlags&quot;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   Option &quot;Xinerama&quot; &quot;true&quot;<br>EndSection<br> </p>

      
    </div>
    <div class="article-info article-info-index">
      
      <a href="/2008/09/16/Dual-Display，Ubuntu下为笔记本实现双显示器/" class="archive-article-date">
  	<time datetime="2008-09-16T07:59:00.000Z" itemprop="datePublished"><i class="icon-clock"></i>2008-09-16</time>
</a>
      
      
	<div class="article-category tagcloud">
	<i class="icon-price-tags"></i>
	<a class="article-category-link" href="/categories/Linux-App/">Linux App</a>
	</div>


      <div class="clearfix"></div>
    </div>
  </div>
</article>










  
    <article id="post-【zz】linux内核参数" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2008/09/16/【zz】linux内核参数/">【zz】linux内核参数</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p> <br><del>my</del><br><br>linux-2.6.26.6/Documentation/kernel-parameters.txt<br><br>console=ttyS0：内核输出到串口<br>eg: qemu  -hda c.img  -serial file:/tmp/qemu.out&#160;&#160;&#160;    # 将启动信息输出到 /tmp/qemu.out<br><br>initcall_debug=1：调用<strong>init节内的函数时输出debug信息<br><br><del>my</del><br><br>ref：<a target="_blank" href="http://doc.linuxpk.com/1163.html">http://doc.linuxpk.com/1163.html</a><br><br>linux内核在启动的时候，能接收某些命令行选项或启动时参数。当内核不能识别某些硬件进而不能设置硬件参数或者为了避免内核更改某些参数的值，可 以通过这种方式手动将这些参数传递给内核。如果不使用启动管理器，比如直接从BIOS或者把内核文件用“cp zImage /dev/fd0”等方法直接从设备启动，就不能给内核传递参数或选项－－这也许是我们使用引导管理器比如LILO的好处之一吧。<br><br>LINUX的内核参数是以空格分开的一个字符串列表，通常具有如下形式：<br><br>name[=value_1][,value_2]…[,value_10]<br><br>“name”是关键字，内核用它来识别应该把“关键字”后面的值传递给谁，也就是如何处理这个值，是传递给处理例程还是作为环境变量或者抛给“init”。值的个数限制为10，你可以通过再次使用该关键字使用超过10个的参数。<br><br>首先，内核检查关键字是不是 <code>root=&#39;,</code>nfsroot=’, <code>nfsaddrs=&#39;,</code>ro’, <code>rw&#39;,</code>debug’或 `init’，然后内核在bootsetups数组里搜索于该关键字相关联的已注册的处理函数，如果找到相关的已注册的处理函数，则调用这些函数并把关键 字后面的值作为参数传递给这些函数。比如你在启动时设置参数name＝a,b,c,d，内核搜索bootsetups数组，如果发现“name”已注册， 则调用“name”的设置函数如name_setup()，并把a,b,c,d传递给name_setup()执行。<br><br>所有型如“name＝value”参数，如果没有被上面所述的设置函数接收，将被解释为系统启动后的环境变量，比如“TERM=vt100”就会被作为一个启动时参数。<br><br>所有没有被内核设置函数接收也没又被设置成环境变量的参数都将留给init进程处理，比如“single”。<br><br>常用的设备无关启动时参数<br><br>1、init＝…<br><br>设置内核执行的初始化进程名，如果该项没有设置，内核会按顺序尝试/etc/init，<br><br>/bin/init，/sbin/init， /bin/sh，如果所有的都没找到，内核会抛出 kernel panic：的错误。<br><br>2、nfsaddrs=…<br><br>设置从网络启动时NFS的启动地址，已字符串的形式给出。<br><br>3、nfsroot=…<br><br>设置网络启动时的NFS根名字，如果该字符串不是以 &quot;/&quot;、&quot;,&quot;、&quot;.&quot;开始，默认指向“/tftp-boot”。<br><br>以上2、3在无盘站中很有用处。<br><br>4、no387<br><br>该选项仅当定义了CONFIG_BUGi386时才能用，某些i387协处理器芯片使用32位的保护模式时会有BUG，比如一些浮点运算，使用这个参数可以让内核忽略387协处理器。<br><br>5、no-hlt<br><br>该选项仅当定义了CONFIG_BUGi386时才能用，一些早期的i486DX-100芯片在处理“hlt”指令时会有问题，执行该指令后不能可靠的返回操作系统，使用该选项，可以让linux系统在CPU空闲的时候不要挂起CPU。<br><br>6、root=…<br><br>该参数告诉内核启动时使用哪个设备作为根文件系统。比如可以指定根文件为hda8：root=/dev/hda8。<br><br>7、ro和rw<br><br>ro参数告诉内核以只读方式加载根文件系统，以便进行文件系统完整性检查，比如运行fsck；rw参数告诉内核以读写方式加载根文件系统，这是默认值。<br><br>8、reserve=…<br><br>保留端口号。格式：reserve=iobase,extent[,iobase,extent]…，用来保护一定区域的I/O端口不被设备驱动程 序自动探测。在某些机器上，自动探测会失败，或者设备探测错误或者不想让内核初始化设备时会用到该参数；比如： reserve= 0x300,32 device=0x300，除device=0x300外所有设备驱动不探测 0x300-0x31f范围的I/O端口。<br><br>9、mem=…<br><br>限制内核使用的内存数量。早期BIOS设计为只能识别64M以下的内存，如果你的内存数量大于64M，你可以指明，如果你指明的数量超过了实际安装的内 存数量，系统崩溃是迟早的事情。如：mem=0x1000000意味着有16M内存，如果是mem=0x6000000，就是96M内存了。<br><br>注意：很多机型把部分内存作为BIOS的映射，所以你在指定内存大小的时候一定要预留空间。你也可以在 pentium或者更新的CPU上使用mem=nopentium关闭4M的页表，这要在内核配置时申明。<br><br>10、panic=N<br><br>默认情况，内核崩溃－－kernel panic 后会宕机而不会重启，你可以设置宕机多少秒之后重启机器；也可以在/proc/sys/kernel/panic文件里设置。<br><br>11、reboot=[warm|cold][,[bios|hard]]<br><br>该选项仅当定义了CONFIG_BUGi386时才能用。2.0.22的内核重启默认为cool reboot，warm reboot 更快，使用&quot;reboot=bios&quot;可以继承bios的设置。<br><br>12、nosmp 和 maxcpus=N<br><br>仅当定义了 </strong>SMP__，该选项才可用。可以用来禁用多CPU或者指明最多支持的CPU个数。<br><br><br><br><br><br><br>内核开发和调试的启动时参数<br><br>这些参数主要用在内核的开发和调试上，如果你不进行类似的工作，你可以简单的跳过本小节。<br><br>1、debug<br><br>linux的日志级别比较多(详细信息可以参看linux/kernel.h)，一般地，日志的守护进程klogd只把比DEBUG级别高的日志写进磁盘；如果使用该选项，klogd也把内核的DEBUG信息写进日志。<br><br>2、profile=N<br><br>在做内核开发的时候，如果想清楚的知道内核在什么地方耗用了多少CPU的时钟周期，可以使用核心的分析函数设置变量prof_shift为非0值，有两 种方式可以实现：一种是在编译时指定，另一种就是通过“profile=”来指定； 他给出了一个相当于最小单位－－即时钟周期；系统在执行内核代码的时候， profile[address &gt;&gt; prof_shift]的值就会累加，你也可以从 /proc/profile得到关于它的一些信息。<br><br>3、swap=N1,N2,N3,N4,N5,N6,N7,N8<br><br>设置内核交换算法的八个参数：max_page_age, page_advance, page_decline, page_initial_age, age_cluster_fract, age_cluster_min, pageout_weight,bufferout_weight。<br><br>4、buff=N1,N2,N3,N4,N5,N6<br><br>设置内核缓冲内存管理的六个参数：max_buff_age,  buff_advance, buff_decline,buff_initial_age, bufferout_weight, buffermem_grace。<br><br>使用 RAMDISK的参数<br><br>(仅当内核配置并编译了 CONFIG_BLK_DEV_RAM)。一般的来说，使用ramdisk并不是一件好事，系统自己会更加有效的使用可用的内存；但是，在启动或者制作启 动盘时，使用ramdisk可以很方便的装载软盘等设备上的映象(尤其是安装程序、启动过程中)，因为在正真使用物理磁盘之前，必须要加载一些必要的模 块，比如文件系统模块，scsi驱动等(可以参见我的initrd-x.x.x.img文件分析－制作安装程序不支持的根文件系统)。<br><br>早期的ramdisk(比如1.3.48的核心)是静态分配的，必须以ramdisk=N来指定ramdisk的大小；现在ramdisk可以动态增加。一共有四个参数，两个布尔型，两个整形。<br><br>1、load_ramdisk=N<br><br>如果N＝1，就加载ramdisk；如果N＝0，就不加载ramdisk；默认值为0。<br><br>2、prompt_ramdisk=N<br><br>N＝1，提示插入软盘；N＝0，不提示插入软盘；默认为1。<br><br>3、ramdisk_size=N或者ramdisk=N<br><br>设定ramdisk的最大值为N KB,默认为4096KB。<br><br>4、ramdisk_start=N<br><br>设置ramdisk的开始块号为N，当ramdisk有内核的映象文件是需要这个参数。<br><br>5、noinitrd<br><br>(仅当内核配置了选项 CONFIG_BLK_DEV_RAM和CONFIG_BLK_DEV_INITRD)现在的内核都可以支持initrd了，引导进程首先装载内核和一个 初始化的ramdisk，然后内核将initrd转换成普通的ramdisk，也就是读写模式的根文件系统设备。然后 linuxrc执行，然后装载真正的根文件系统，之后ramdisk被卸载，最后执行启动序列，比如/sbin/init。<br><br>选项noinitrd告诉内核不执行上面的步骤，即使内核编译了initrd，而是把initrd的数据写到 /dev/initrd，只是这是一个一次性的设备。 </p>

      
    </div>
    <div class="article-info article-info-index">
      
      <a href="/2008/09/16/【zz】linux内核参数/" class="archive-article-date">
  	<time datetime="2008-09-16T04:36:00.000Z" itemprop="datePublished"><i class="icon-clock"></i>2008-09-16</time>
</a>
      
      
	<div class="article-category tagcloud">
	<i class="icon-price-tags"></i>
	<a class="article-category-link" href="/categories/Linux/">Linux</a>
	</div>


      <div class="clearfix"></div>
    </div>
  </div>
</article>










  
    <article id="post-ubuntu-8-04：linux-restricted-modules-linux-ubuntu-modules" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2008/09/09/ubuntu-8-04：linux-restricted-modules-linux-ubuntu-modules/">ubuntu-8.04：linux-restricted-modules &amp; linux-ubuntu-modules</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p> <br><br><br>如何编译内核：<br><br>1. 安装Linux源代码<br>下载2.6.24-21-generic版本内核：<br>apt-get source linux-image-2.6.24-21-generic<br>下载当前使用版本内核：<br>apt-get source linux-image-$(uname -r)<br>注意，打过补丁后Linux的版本号需要手动更改，修改Makefile如下：<br>VERSION = 2<br>PATCHLEVEL = 6<br>SUBLEVEL = 24<br> #EXTRAVERSION = .3<br> EXTRAVERSION = -21-generic<br><br>2. 编译内核<br>a. 传统方法<br>make menuconfig<br>make bzImage<br>make modules<br>make install&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      # 将bzImage拷贝至在/boo/ 目录下的vmlinuz，并创建符号链接<br>make modules_install&nbsp;&nbsp;&nbsp;       # 会在/lib/modules/下创建2.6.24-21-generic目录<br>sudo mkinitramfs -o initrd.img-2.6.24-21-generic 2.6.24-21-generic<br><br>b. 使用debian编译系统<br>CONCURRENCY_LEVEL=2 AUTOBUILD=1 NOEXTRAS=1 fakeroot debian/rules binary-generic<br>具体介绍 ref：<a target="_blank" href="http://wiki.ubuntu.org.cn/index.php?title=UbuntuHelp:Kernel/Compile/zh&amp;variant=zh-cn#Speeding_Up_The_Build">http://wiki.ubuntu.org.cn/index.php?title=UbuntuHelp:Kernel/Compile/zh&amp;variant=zh-cn#Speeding_Up_The_Build</a><br><br><br>如何编译 linux-restricted-modules 和 linux-ubuntu-modules：<br><br>1. 安装如下deb包<br>fakeroot、build-essential、kernel-wedge、debhelper、dpkg-dev、po-debconf<br><br>2. 下载源码包<br>apt-get source linux-restricted-modules-common<br>apt-get source linux-ubuntu-modules-2.6.24-21-generic<br><br>3. 编译linux-restricted-modules-common<br>cd linux-restricted-modules-2.6.<em><br>修改 debian/rules 中的 abi_version=21、kernel_version=2.6.24<br>修改 debian/rules 中的 flavours := $(addprefix $(kernel_abi_version)-,generic)<br>修改 debian/d-i/kernel-versions.in，注释掉除了 generic 以外的其他行<br>debian/rules debian/control <br> fakeroot debian/rules binary<br>ref <a target="_blank" href="http://wiki.ubuntu.org.cn/index.php?title=UbuntuHelp:Kernel/Compile/zh&amp;variant=zh-cn#Speeding_Up_The_Build">http://wiki.ubuntu.org.cn/index.php?title=UbuntuHelp:Kernel/Compile/zh&amp;variant=zh-cn#Speeding_Up_The_Build</a><br><br>4. 编译linux-ubuntu-modules-2.6.24-21-generic<br>cd linux-ubuntu-modules-2.6.</em><br>fakeroot debian/rules binary-arch arch=i386 flavours=&quot;generic&quot;&nbsp;&nbsp;&nbsp;       # debian/rules中有一个如何编译的example<br><br>5. 安装deb包<br>经过3，4两步编译，将在上一层目录../下生成一系列deb包<br>安装deb包<br>dpkg -i linux-restricted-modules-2.6.24-21-generic<em>.deb <br>dpkg -i linux-ubuntu-modules-2.6.24-21-generic</em>.deb<br><br><br>－－－－－－－－－－<br>deb工具包 module-assistant：tool to make module package creation easier<br>其用法实例参见<br><a target="_blank" href="https://help.ubuntu.com/community/BinaryDriverHowto/ATI?highlight=(linux -restricted -modules)#Instructions%20for%207.04%20(Feisty)">https://help.ubuntu.com/community/BinaryDriverHowto/ATI?highlight=(linux-restricted-modules)#Instructions%20for%207.04%20(Feisty)</a><br>－－－－－－－－－－<br><br>如何动态生成内核驱动模块：<br><br>以如ATI显卡模块fglrx.ko为例<br><br>当 linux-restricted-modules-2.6.24-16-generic deb 包被安装后，在 /lib/linux-restricted-modules/2.6.24-16-generic/ 目录下会有一个 fglrx 文件夹，放置有生成 fglrx.ko 模块所需的 <em>.o 文件<br><br>系统启动过程执行脚本 /etc/init.d/linux-restricted-modules-common<br>它会调用 /sbin/lrm-manager –quick<br><br>脚本 lrm-manager 读取配置文件 /etc/default/linux-restricted-modules-common<br>如果配置中没有禁用 fglrx 模块，则 lrm-manager 会根据 fglrx/ 目录下的 </em>.o 文件，生成内核模块 fglrx.ko<br><br>因此如果根据ATI显卡驱动源码自己编译驱动模块，而不使用 linux-restricted-modules-2.6.24-16-generic deb包安装 fglrx 驱动，应该在该配置文件中禁用 fglrx<br><br>同样，/lib/linux-restricted-modules/2.6.24-16-generic/ 下的其他文件夹中的 <em>.o 文件，用于动态生成对应 </em>.ko 模块，如果不需要，则在配置文件中禁用<br><br><br><br><br><br><br><br><br><del>end</del> </p>

      
    </div>
    <div class="article-info article-info-index">
      
      <a href="/2008/09/09/ubuntu-8-04：linux-restricted-modules-linux-ubuntu-modules/" class="archive-article-date">
  	<time datetime="2008-09-08T16:14:00.000Z" itemprop="datePublished"><i class="icon-clock"></i>2008-09-09</time>
</a>
      
      
	<div class="article-category tagcloud">
	<i class="icon-price-tags"></i>
	<a class="article-category-link" href="/categories/Linux-App/">Linux App</a>
	</div>


      <div class="clearfix"></div>
    </div>
  </div>
</article>










  
    <article id="post-PPTP-Client" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2008/09/01/PPTP-Client/">PPTP Client</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p> <br>pptpclient-how-to <a target="_blank" href="http://pptpclient.sourceforge.net/howto-ubuntu.phtml">http://pptpclient.sourceforge.net/howto-ubuntu.phtml</a><br>vpn-routing <a href="http://pptpclient.sourceforge.net/routing.phtml#client-to-server" target="_blank">http://pptpclient.sourceforge.net/routing.phtml#client-to-server</a><br><br><br>~~ my config <del><br><br><strong>a. vi /etc/ppp/chap-secrets</strong><br>#client server Password IP Address <br>#域名\用户名 服务器名 密码<br>vance&nbsp;&nbsp;&nbsp;      &quot;pptpd.vance&quot;&nbsp;&nbsp;&nbsp;      123456&nbsp;&nbsp;&nbsp;      *<br><br><strong>b. vi /etc/ppp/options.pptp</strong><br>lock<br>noauth<br>refuse-eap<br>refuse-chap<br>refuse-mschap<br>nobsdcomp<br>nodeflate<br>#require-mppe-128<strong>c. vi /etc/ppp/peers/vpn.lab113</strong><br># 10.214.9.113&mdash;&mdash;VPN服务器地址<br>pty &quot;pptp 10.214.9.113 –nolaunchpppd&quot;<br>#linkname: Sets the logical name of the link. Pppd will create a <br># file named ppp-pptpd.vance.lab113 in /var/run containing its PID<br>linkname pptpd.vance.lab113<br>name vance&nbsp;&nbsp;        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      # 与<strong>chap-secrets</strong>中的client相对应<br>remotename pptpd.vance&nbsp;&nbsp;&nbsp;      # 与<strong>chap-secrets</strong>中的server相对应<br>file /etc/ppp/options.pptp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      #  配置文件所在位置<br>usepeerdns<br>defaultroute&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      # 将peer设置为默认网关<br>replacedefaultroute&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      # 并且替换原来的默认网关<br>#ipparam lab113<br><br><strong>d. 拨号<br></strong>pppd call vpn.lab113 <br>或<br>pon vpn.lab113<br>poff vpn.lab113&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      # 断开<br>debug模式：<br>pppd call vpn.lab113 logfd 2 nodetach&amp;<br>或<br>pon vpn.lab113 debug dump logfd 2 nodetach<br><br>updetach选项<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     With this option, pppd will detach from its controlling terminal<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     once it has successfully established the ppp connection (to  the<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     point  where  the first network control protocol, usually the IP<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     control protocol, has come up). <br><strong><br><br><br></strong><strong> </strong></del> end my config <del><br><br><br><br><hr><br><strong>PPTP Client</strong><br><br> <strong>Ubuntu HOWTO</strong><p> </p>by James Cameron<br>29th November 2007<p><strong>Community Ubuntu Documentation</strong></p><p>Ubuntu have formed a community that documents most common tasks.  As at 2007-11, the documentation for using PPTP on Ubuntu can be found at: <a href="https://help.ubuntu.com/community/VPNClient" target="_blank" rel="external"> https://help.ubuntu.com/community/VPNClient</a></p><p> </p><hr><strong>Ubuntu Gutsy 7.10</strong> <ul> <li>install the <em>network-manager-pptp</em> package, using the Add/Remove, Synaptic package manager, or <em>apt-get</em>,</li> <li>click network icon, choose <em>VPN Connections</em> then <em>Configure VPN</em>, then add a VPN with the wizard,</li> <li>click network icon, then <em>VPN Connections</em> then the VPN you created.</li> </ul>    If you have a problem after doing this, watch the logs to see if it worked:    <p> </p> <p>To increase logging, add <em>debug dump</em> to the <tt>/etc/ppp/options</tt> and try again.</p> <p>Reference: tests by James Cameron on 29th November 2007, during diagnosis of a mailing list thread.</p> <p> </p> <hr> <strong>Ubuntu Feisty</strong> <p> </p> <ul> <li>install the <em>network-manager-pptp</em> package, and if it was not already installed, restart the network manager applet and Network Manager:        <ul> <li>right-click the network icon on your system tray and choose <em>Remove</em>,</li> <li>Alt/F2, run <em>nm-applet</em>, and the network icon will return,</li> <li>restart Network Manager:            <p> </p> </li> </ul> </li> <li>left-click network icon, choose <em>VPNS</em> then <em>configure</em>, then add a VPN with the wizard,</li> <li>left-click network icon, then <em>VPNS</em> then the VPN you created,</li> <li>watch the logs to see if it worked:        <p> </p> </li> </ul>        Reference: <a href="http://shiny.thorne.id.au/2007/01/pptp-from-ubuntu.html" target="_blank" rel="external">PPTP From Ubuntu</a>, by Stephen Thorne.  <hr>        Below are instructions for installing PPTP Client on Ubuntu Linux, last tested with the 5.10 Breezy version on i386, but also is said to work for 6.06 on i386.  The Ubuntu kernel has MPPE already.        <p>Contents: </p> <ul> <li><a href="http://pptpclient.sourceforge.net/howto-ubuntu.phtml#install" target="_blank" rel="external">installing the client program</a></li> <li><a href="http://pptpclient.sourceforge.net/howto-ubuntu.phtml#install_gui" target="_blank" rel="external">installing the configuration program</a></li> <li><a href="http://pptpclient.sourceforge.net/howto-ubuntu.phtml#configure_gui" target="_blank" rel="external">configuring a tunnel using the configuration program</a></li> <li><a href="http://pptpclient.sourceforge.net/howto-ubuntu.phtml#configure_by_hand" target="_blank" rel="external">configuring a tunnel by hand</a></li> </ul> <a name="sources"><hr> </a> <strong>Configure Ubuntu to use Universe</strong> <p>Add the universe repository to your sources list.  See <a href="http://ubuntuforums.org/showthread.php?p=1740779" target="_blank" rel="external">this thread</a> for references.</p> <p><a name="install"><hr> </a> <strong>Installing the Client Program</strong></p> <p>Install PPTP Client from the Ubuntu Project:</p> <p> </p> <p><a name="install_gui"><hr> </a> <strong>Installing the Configuration Program</strong></p> <p>Note: you may wish to skip the configuration program and <a href="http://pptpclient.sourceforge.net/howto-ubuntu.phtml#configure_by_hand" target="_blank" rel="external">configure the client by hand</a>.  </p> <ol> <li>add the following lines to the sources list file, <tt>/etc/apt/sources.list</tt> :                <p> </p> <p>Note: can use a text editor, or simply <em>cat</em> the lines on to the end of the file using <em>&gt;&gt;</em>, but if you make a mistake in formatting you will likely be told by the <em>apt-get update</em> step.</p> <p> </p> </li> <li>update the list of packages:                <p> </p> <p> </p> </li> <li>install the PPTP Client GUI:                <p> </p> <p>Note: you may be told that the packages could not be authenticated. For the moment, tell your system to install them anyway.  We’ll take patches to our release process if anyone can explain simply how to provide authentication.</p> <p> </p> </li> </ol> <a name="configure_gui"><hr> </a> <strong>Configuration</strong> <p> </p> <ol> <li>obtain from your PPTP Server administrator:                    <p> </p> <ul> <li>the IP address or host name of the server,</li> <li>the authentication domain name, (e.g. WORKGROUP),</li> <li>the username you are to use,</li> <li>the password you are to use,</li> <li>whether encryption is required.</li> </ul> <p> </p> </li> <li>run <em>pptpconfig</em> <a href="http://pptpclient.sourceforge.net/howto-diagnosis.phtml#x_display" target="_blank" rel="external">as root</a>, and a window should appear,                    <p><img height="213" width="309" src="http://img.pickbox.me/wp-content/uploads/pic/other_site/pptpclient_sourceforge_ss-1.png"></p> <p> </p> </li> <li>enter the server, domain, username and password into the <em>Server</em> tab,                    <p> </p> </li> <li>if you decided in Installation step 1 above that you would need MPPE, and if your administrator says encryption is required, then on the <em>Encryption</em> tab, click on <em>Require Microsoft Point-to-Point Encryption (MPPE)</em>,                    <p><img height="85" width="303" src="http://img.pickbox.me/wp-content/uploads/pic/other_site/pptpclient_sourceforge_ss-4-encryption.png"></p> <p> </p> </li> <li>click on <em>Add</em>, and the tunnel will appear in the list,                    <p> </p> </li> <li>click on the tunnel to select it, click on <em>Start</em>, and a window will appear with the tunnel connection log and status,                    <p> </p> </li> <li>if the connection fails, you will need to gather more information, so on the <em>Miscellaneous</em> tab, click on <em>Enable connection debugging facilities</em>, click <em>Update</em>, try <em>Start</em> again, then look at the <a href="http://pptpclient.sourceforge.net/howto-diagnosis.phtml" target="_blank" rel="external">Diagnosis HOWTO</a> for whatever error is displayed.                    <p><img height="85" width="303" src="http://img.pickbox.me/wp-content/uploads/pic/other_site/pptpclient_sourceforge_ss-5-misc.png"></p> <p> </p> </li> <li>if the connection succeeded, you can try the <em>Ping</em> test button.  If the ping fails, you should try to find out why before proceeding.  If the ping works, then the tunnel is active and you may now work on routing.                    <p> </p> </li> <li>decide whether all your network traffic should go via the tunnel or not.  If so, <em>Stop</em> the tunnel, select it again, then on the <em>Routing</em> tab, click on <em>All to Tunnel</em>, then click <em>Update</em> and try <em>Start</em> again.  Now try to access the network behind the server.                    <p> </p> </li> <li>on the other hand, if only some of your network traffic should go via the tunnel, you will need to obtain from the server administrator or folk lore a series of network routes to enter.  <em>Stop</em> the tunnel, select it again, then click on either <em>Client to LAN</em> or <em>LAN to LAN</em> on the <em>Routing</em> tab, use the <em>Edit Network Routes</em> button to enter the routes one by one, and then try <em>Start</em> again.  Now try to access the network behind the server.                    <p><img height="150" width="256" src="http://img.pickbox.me/wp-content/uploads/pic/other_site/pptpclient_sourceforge_ss-2a-client-to-lan.png"></p> <p>For further help with Routing, read our <a href="http://pptpclient.sourceforge.net/routing.phtml" target="_blank" rel="external">Routing HOWTO</a>.</p> <p> </p> </li> </ol> <hr> <strong>Diagnosing Problems</strong> <p>If you have problems with the tunnel and need to ask for help, start  <tt>pppd</tt> with complete logging:</p> <p> </p> <p>where <em>tunnelname</em> is the name of the tunnel you created in the configuration program.  For more detail, see <a href="http://pptpclient.sourceforge.net/howto-diagnosis.phtml#debug" target="_blank" rel="external">enabling debug logging</a>.</p> <p>This will give you a file <tt>pptp.log</tt> that you can use to search for known solutions in the <a href="http://pptpclient.sourceforge.net/howto-diagnosis.phtml" target="_blank" rel="external">Diagnosis HOWTO</a> or attach to an e-mail to the <a href="http://pptpclient.sourceforge.net/contact.phtml" target="_blank" rel="external">mailing list</a>.</p> <p><a name="configure_by_hand"><hr> </a> <strong>Configuration, by hand</strong></p> <p> </p> <li>obtain from your PPTP Server administrator:                    <p> </p> <ul> <li>the IP address or host name of the server ($SERVER),</li> <li>the name you wish to use to refer to the tunnel ($TUNNEL),</li> <li>the authentication domain name ($DOMAIN),</li> <li>the username you are to use ($USERNAME),</li> <li>the password you are to use ($PASSWORD),</li> <li>whether encryption is required.</li> </ul> <p>In the steps below, substitute these values manually.  For example, where we write $PASSWORD we expect you to replace this with your password.</p> <p> </p> </li> <li>create or edit the <tt>/etc/ppp/options.pptp</tt> file, which sets options common to all tunnels:                    <p> </p> <p> </p> </li> <li>create or add lines to the <tt>/etc/ppp/chap-secrets</tt> file, which holds usernames and passwords:                    <p> </p> <p>Note: if you are using a PPTP Server that does not require an authentication domain name, omit the slashes as well as the domain name.</p> <p>Note: if the passwords contain any special characters, quote them. See <tt>man pppd</tt> for more details.</p> <p> </p> </li> <li>create a <tt>/etc/ppp/peers/$TUNNEL</tt> file:                    <p> </p> <p>Note: if you do not need MPPE support, then remove the <em>require-mppe-128</em> option from this file and <tt>/etc/ppp/options.pptp</tt>.</p> <p> </p> </li> <li>start the tunnel using the <em>pon</em> command:                    <p> </p> <p>to further diagnose a failure, add options to the command:</p> <p> </p> <p>Note: we have further information on <a href="http://pptpclient.sourceforge.net/howto-diagnosis.phtml#debug" target="_blank" rel="external">enabling debug mode</a>, and on <a href="http://pptpclient.sourceforge.net/howto-diagnosis.phtml" target="_blank" rel="external">diagnosing problems</a>.</p> <p> </p> </li> <li>stop the tunnel using the <em>poff</em> command:                    <p> </p> <p> </p> </li> <li>to script the tunnel connection so that something is done as soon as the tunnel is up, use either <tt>ip-up.d</tt> scripts or the <em>updetach</em> keyword.                    <p> </p> <ol> <li>see the <a href="http://pptpclient.sourceforge.net/routing.phtml#automatic-setup" target="_blank" rel="external">Routing HOWTO</a> for examples of <tt>ip-up.d</tt> scripting that adds routes or iptables rules.                        <p> </p> </li> <li>using <em>updetach</em> will cause <tt>pppd</tt> to fork, detach, and exit with success once the network link is up.  This example connects a provider link, then the tunnel, then runs <tt>fetchmail</tt> to get new e-mail:                        <p> </p> <p>Note: the double ampersand &amp;&amp; means that the commands following it will only be executed if the command to the left of it was successful.  If the tunnel fails to connect, the fetchmail will not happen.</p> <p> </p> </li> </ol> </li> <li>to have the tunnel automatically restarted if it fails, add the option <em>persist</em> to either the command line or the <tt>/etc/ppp/peers/$TUNNEL</tt> file.                    <p> </p> </li> <li>to have the tunnel started on system boot:                    <p> </p> <ul> <li>for Debian Sarge and later, edit the <tt>/etc/network/interfaces</tt> file, and add this section:                        <p> </p> <p> </p> </li> <li>for Debian Woody, edit the <tt>/etc/ppp/no_ppp_on_boot</tt> file, remove the first line comment, and change the word <em>provider</em> to the name of your tunnel, so that it looks like this:                        <p> </p> <p>(The line … means the other lines in the file, it doesn’t mean a line with three dots.)</p> <p>Then rename the no_ppp_on_boot file and make it executable:</p> <p> </p> </li> </ul>                    Every time your computer starts, the tunnel will be started automatically.                    <p> </p> </li> <li>to set up routing, read our <a href="http://pptpclient.sourceforge.net/routing.phtml" target="_blank" rel="external">Routing HOWTO</a>.</li> <br> <em><tt>#!/bin/sh<br>                    # modified by jfo, 2008-9-2<br>                    # pppd ip-up script for all-to-tunnel routing<br>                    # you can place it in /etc/ppp/ip-up.d/<br> <br>                    # name of primary network interface (before tunnel)<br>                    #PRIMARY=eth0<br>                    PRIMARY=$(ip route | grep default | cut -d&quot; &quot; -f 3)<br>                    PRIMARY_DEV=$(ip route | grep default | cut -d&quot; &quot; -f 5)<br> <br>                    # address of tunnel server<br>                    SERVER=tunnel.example.com<br> <br>                    # provided by pppd: string to identify connection aka ipparam option<br>                    CONNECTION=$6<br>                    if [ &quot;${CONNECTION}&quot; = &quot;&quot; ]; then CONNECTION=${PPP_IPPARAM}; fi<br> <br>                    # provided by pppd: interface name<br>                    TUNNEL=$1<br>                    if [ &quot;${TUNNEL}&quot; = &quot;&quot; ]; then TUNNEL=${PPP_IFACE}; fi<br> <br>                    # if we are being called as part of the tunnel startup<br>                    if [ &quot;${CONNECTION}&quot; = &quot;tunnel&quot; ] ; then<br> <br>                    &nbsp;&nbsp;   # direct tunnelled packets to the tunnel server<br>                    &nbsp;&nbsp;   # route add -host ${SERVER} dev ${PRIMARY}<br>                    &nbsp;&nbsp;   route add -host ${SERVER} gw ${PRIMARY}<br> <br>                    &nbsp;&nbsp;   # direct all other packets into the tunnel<br>                    &nbsp;&nbsp;   route del default ${PRIMARY_DEV}<br>                    &nbsp;&nbsp;   route add default dev ${TUNNEL}<br> <br>                    fi</tt></em><br> <br> <br> <br> <br> <br> <br> <br> <br>                    ~~end</del> </p>

      
    </div>
    <div class="article-info article-info-index">
      
      <a href="/2008/09/01/PPTP-Client/" class="archive-article-date">
  	<time datetime="2008-09-01T09:18:00.000Z" itemprop="datePublished"><i class="icon-clock"></i>2008-09-01</time>
</a>
      
      
	<div class="article-category tagcloud">
	<i class="icon-price-tags"></i>
	<a class="article-category-link" href="/categories/Network/">Network</a>
	</div>


      <div class="clearfix"></div>
    </div>
  </div>
</article>










  
    <article id="post-【zz】Ubuntu-Installation" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2008/08/29/【zz】Ubuntu-Installation/">【zz】Ubuntu Installation</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p> <a href="http://hi.baidu.com/jmlover/blog/item/1a24314e482153cbd1c86a0a.html" target="_blank">【zz】http://hi.baidu.com/jmlover/blog/item/1a24314e482153cbd1c86a0a.html</a><br><a href="http://hi.baidu.com/flyship163/blog/item/d24ca72f9f53743b1f3089f7.html" target="_blank">【ref】 http://hi.baidu.com/flyship163/blog/item/d24ca72f9f53743b1f3089f7.html</a><br><br><br><del>my</del><br><br>源 <strong><a target="_blank" href="http://ppa.launchpad.net/">http://ppa.launchpad.net/</a></strong><br><br><del>my</del><br><br><em>从硬盘安装DVD版ubuntu-8.04.1-dvd-i386.iso</em><br><br>root (hd0,4) <br>kernel /vmlinuz boot=casper iso-scan/filename=/ubuntu-8.04.1-dvd-i386.iso [ quiet splash ro automatic-ubiquity locale=zh_CN.UTF-8 ]<br>initrd /initrd.gz <br><br><del>my</del><br><br><em>克隆wubi安装的ubuntu系统</em><br>（1）安装两个软件以增强硬件检测能力<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;    sudo apt-get install discover1 xresprobe  <br>（2）将&ldquo;ubuntu&rdquo;文件夹复制到目标机某分区根目录。<br>（3）设置启动。修改 menu.lst 中的 UUID ，一个获得 UUID 的方法：在目标机上启动 ubuntu live cd ，运行命令 sudo ls -l /dev/disk/by-uuid ，即可看到各分区对应的 UUID 。 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;    实际上下面两种写法是等价的：<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;    root=UUID=13A0842F0E3C67D1<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;    root=/dev/sda6<br><br><del>my</del><br>Ubuntu Installation</p><p>Last updated $Date: 2007-05-22 07:21:52 $</p><p><a href="http://www.iki.fi/kuparine/english.html" target="_blank" rel="external">Martti Kuparinen</a> <code>&lt;&gt;</code></p><p><a href="http://www.iki.fi/kuparine/comp/ubuntu/install.html" target="_blank" rel="external">http://www.iki.fi/kuparine/comp/ubuntu/install.html</a></p><a name="abstract">Abstract</a><p><em> This is how I installed and configured my PC running Ubuntu 6.06.1 LTS. With this setup I was able remove Windows XP partition from my PC. The few programs which require a real Windows (e.g. program to update Topfield 5100 PVR’s firmware can’t be run with Wine) are executed inside VMware. </em></p><hr><p>[ Please note that this page is also available in <a href="http://users.piuha.net/martti/comp/ubuntu/asenna.html" target="_blank" rel="external">Finnish</a> ] <br><br>[ See also <a href="http://users.piuha.net/martti/comp/ubuntu/server.html" target="_blank" rel="external">My Ubuntu Server Installation with VMware Server</a> and <a href="http://users.piuha.net/martti/comp/ubuntu/encfs.html" target="_blank" rel="external">Encrypted directories with EncFS in My Ubuntu Installation</a> ]</p><hr>Table of Contents<dl><dt><a href="http://users.piuha.net/martti/comp/ubuntu/install.html#1" target="_blank" rel="external">1.  Introduction</a></dt><dt><a href="http://users.piuha.net/martti/comp/ubuntu/install.html#2" target="_blank" rel="external">2.  Initial install</a></dt><dt><a href="http://users.piuha.net/martti/comp/ubuntu/install.html#3" target="_blank" rel="external">3.  Adding more software repositories</a></dt><dt><a href="http://users.piuha.net/martti/comp/ubuntu/install.html#4" target="_blank" rel="external">4.  Installing applications</a></dt><dt><a href="http://users.piuha.net/martti/comp/ubuntu/install.html#5" target="_blank" rel="external">5.  Installing and configuring SSH server</a></dt><dt><a href="http://users.piuha.net/martti/comp/ubuntu/install.html#6" target="_blank" rel="external">6.  Configuring X</a></dt><dt><a href="http://users.piuha.net/martti/comp/ubuntu/install.html#7" target="_blank" rel="external">7.  Installing VMware Workstation</a></dt><dt><a href="http://users.piuha.net/martti/comp/ubuntu/install.html#8" target="_blank" rel="external">8.  Installing VMware Server</a></dt><dt><a href="http://users.piuha.net/martti/comp/ubuntu/install.html#9" target="_blank" rel="external">9.  Installing VMware Player</a></dt><dt><a href="http://users.piuha.net/martti/comp/ubuntu/install.html#10" target="_blank" rel="external">10. DMA settings</a></dt><dt><a href="http://users.piuha.net/martti/comp/ubuntu/install.html#11" target="_blank" rel="external">11. Configuring firewall</a></dt><dt><a href="http://users.piuha.net/martti/comp/ubuntu/install.html#12" target="_blank" rel="external">12. Useful links</a></dt></dl> <hr><a name="1">1. Introduction</a><p>This document and the <a href="http://users.piuha.net/martti/comp/ubuntu/install.sh" target="_blank" rel="external">installation helper script</a> applies to Ubuntu 6.06.1 LTS (also known as Dapper Drake). The script also works in the newer Ubuntu 6.10 (Edgy Eft) and 7.04 (Feisty Fawn).</p><a name="2">2. Initial install</a><p>Start by fetching the installation CD image from the <a href="http://www.ubuntulinux.org/download/" target="_blank" rel="external">Ubuntu download page</a>. Personally I want to use the text-based installation so I used the &quot;Alternate install CD&quot; image. Make sure the MD5 checksum matches with the published value before burning the ISO file or the installation may fail. Reboot with the new installation CD and follow the instructions to install Ubuntu.</p><p>Before installing think few minutes how to divide the hard disk into multiple filesystems. In my opinion it’s important to have a separate filesystem for /home so it’s even possible to reinstall the whole system without moving your personal data to some temporary location before reinstall. I have two identical 250 GB SATA disks. See this page <a href="http://users.piuha.net/martti/comp/ubuntu/raid.html" target="_blank" rel="external">how I configured RAID-1</a> to have some protection agaist disk failures.</p><p>Most the following steps can be performed automatically by saving this <a href="http://users.piuha.net/martti/comp/ubuntu/install.sh" target="_blank" rel="external">install.sh</a> script on your Desktop and running it inside a terminal (<strong>Applications &gt; Accessories &gt; Terminal</strong>). It is safe to run the script multiple times if you need to abort it at some point.</p># <strong>sh ~/Desktop/install.sh</strong><p>Currently the <a href="http://users.piuha.net/martti/comp/ubuntu/install.sh" target="_blank" rel="external">install.sh</a> script does not install and/or configure the following applications so these must be done manually by following this document:</p><ul> <li>applications using Wine</li> <li>firewall</li> <li>VMware Workstation</li> <li>VMware Server</li></ul><a name="3">3. Adding more software repositories</a><p>Login to the newly installed Ubuntu system and select <strong>Applications &gt; Accessories &gt; Terminal</strong>. Modify <code>/etc/apt/sources.list</code> and update your newly installed system. With these settings you have more applications available for download and install. Replace <code>fi</code> with your country code (fi = Finland, se = Sweden, …) in the following example to access the closest national mirror.</p># <strong>sudo gedit /etc/apt/sources.list</strong><br><br>deb <a href="http://fi.archive.ubuntu.com/ubuntu" target="_blank" rel="external">http://fi.archive.ubuntu.com/ubuntu</a> dapper main restricted<br>deb-src <a href="http://fi.archive.ubuntu.com/ubuntu" target="_blank" rel="external">http://fi.archive.ubuntu.com/ubuntu</a> dapper main restricted<br><br>## MAJOR BUG FIX UPDATES produced after the final release<br>deb <a href="http://fi.archive.ubuntu.com/ubuntu" target="_blank" rel="external">http://fi.archive.ubuntu.com/ubuntu</a> dapper-updates main restricted<br>deb-src <a href="http://fi.archive.ubuntu.com/ubuntu" target="_blank" rel="external">http://fi.archive.ubuntu.com/ubuntu</a> dapper-updates main restricted<br><br>## UBUNTU SECURITY UPDATES<br>deb <a href="http://fi.archive.ubuntu.com/ubuntu" target="_blank" rel="external">http://fi.archive.ubuntu.com/ubuntu</a> dapper-security main restricted<br>deb-src <a href="http://fi.archive.ubuntu.com/ubuntu" target="_blank" rel="external">http://fi.archive.ubuntu.com/ubuntu</a> dapper-security main restricted<br><br>## UNIVERSE AND MULTIVERSE REPOSITORY<br>deb <a href="http://fi.archive.ubuntu.com/ubuntu" target="_blank" rel="external">http://fi.archive.ubuntu.com/ubuntu</a> dapper universe multiverse<br>deb <a href="http://fi.archive.ubuntu.com/ubuntu" target="_blank" rel="external">http://fi.archive.ubuntu.com/ubuntu</a> dapper-security universe multiverse<br>deb-src <a href="http://fi.archive.ubuntu.com/ubuntu" target="_blank" rel="external">http://fi.archive.ubuntu.com/ubuntu</a> dapper universe multiverse<br>deb-src <a href="http://fi.archive.ubuntu.com/ubuntu" target="_blank" rel="external">http://fi.archive.ubuntu.com/ubuntu</a> dapper-security universe multiverse<br><br>## BACKPORTS REPOSITORY<br>deb <a href="http://fi.archive.ubuntu.com/ubuntu" target="_blank" rel="external">http://fi.archive.ubuntu.com/ubuntu</a> dapper-backports main restricted<br>deb <a href="http://fi.archive.ubuntu.com/ubuntu" target="_blank" rel="external">http://fi.archive.ubuntu.com/ubuntu</a> dapper-backports universe multiverse<br>deb-src <a href="http://fi.archive.ubuntu.com/ubuntu" target="_blank" rel="external">http://fi.archive.ubuntu.com/ubuntu</a> dapper-backports main restricted<br>deb-src <a href="http://fi.archive.ubuntu.com/ubuntu" target="_blank" rel="external">http://fi.archive.ubuntu.com/ubuntu</a> dapper-backports universe multiverse<br><br>## dapper-commercial by Canonical<br>deb <a href="http://archive.canonical.com/ubuntu" target="_blank" rel="external">http://archive.canonical.com/ubuntu</a> dapper-commercial main<br><br>## WINE<br>deb <a href="http://wine.budgetdedicated.com/apt" target="_blank" rel="external">http://wine.budgetdedicated.com/apt</a> dapper main<br>deb-src <a href="http://wine.budgetdedicated.com/apt" target="_blank" rel="external">http://wine.budgetdedicated.com/apt</a> dapper main<br><br>## Finnish spelling checker for OpenOffice.org<br>deb <a href="http://www.lemi.fi/voikko/ubuntu" target="_blank" rel="external">http://www.lemi.fi/voikko/ubuntu</a> dapper/<br>deb-src <a href="http://www.lemi.fi/voikko/ubuntu" target="_blank" rel="external">http://www.lemi.fi/voikko/ubuntu</a> dapper/<br><br>## MEDIBUNTU REPOSITORY<br>deb <a href="http://medibuntu.sos-sts.com/repo/" target="_blank" rel="external">http://medibuntu.sos-sts.com/repo/</a> dapper free non-free<br>deb-src <a href="http://medibuntu.sos-sts.com/repo/" target="_blank" rel="external">http://medibuntu.sos-sts.com/repo/</a> dapper free non-free<p>Now launch <strong>System &gt; Administration &gt; Synaptic Package Manager</strong>. Type your password if prompted. Press the <strong>Reload</strong> button. You will see a warning about missing repositories, this okay during the first time. Press <strong>Mark All Upgrades</strong> and press <strong>Apply</strong> if it’s enabled. You should now have the latest version of all packages. If the Apply button is not enabled it means you have nothing to upgrade, in other words you already have the latest versions installed.</p><a name="4">4. Installing applications</a><p>Next install the following programs. The following commands should be executed on a terminal window (<strong>Applications &gt; Accessories &gt; Terminal</strong>).</p>## Some public keys<br># <strong>cd /tmp</strong><br># <strong>wget <a href="http://medibuntu.sos-sts.com/repo/medibuntu-key.gpg" target="_blank" rel="external">http://medibuntu.sos-sts.com/repo/medibuntu-key.gpg</a></strong><br># <strong>sudo apt-key add medibuntu-key.gpg</strong><br><br># <strong>cd /tmp</strong><br># <strong>wget <a href="http://www.lemi.fi/voikko/archive-key-1.asc" target="_blank" rel="external">http://www.lemi.fi/voikko/archive-key-1.asc</a></strong><br># <strong>sudo apt-key add archive-key-1.asc</strong><br>#<br># <strong>cd /tmp</strong><br># <strong>wget <a href="http://wine.budgetdedicated.com/apt/387EE263.gpg" target="_blank" rel="external">http://wine.budgetdedicated.com/apt/387EE263.gpg</a></strong><br># <strong>sudo apt-key add 387EE263.gpg</strong><br><br>## Language support (fi = Finnish, se = Swedish, …)<br># <strong>sudo apt-get install language-pack-fi language-support-fi</strong><br># <strong>sudo apt-get install language-pack-gnome-fi</strong><br><br>## Finnish spelling checker for OpenOffice.org<br># <strong>sudo apt-get install openoffice.org-voikko</strong><br><br>## Flash<br># <strong>sudo apt-get install flashplugin-nonfree</strong><br><br>## RealPlayer<br># <strong>sudo apt-get install realplay</strong><br>or<br># <strong>sudo apt-get install helix-player mozilla-helix-player</strong><br><br>## Acroread<br># <strong>sudo apt-get install acroread</strong><br># <strong>sudo apt-get install mozilla-acroread</strong><br># <strong>sudo apt-get install acroread-plugins</strong><br><br>## Java<br># <strong>sudo apt-get install sun-java5-jre sun-java5-fonts sun-java5-plugin</strong><br># <strong>sudo update-alternatives –set java /usr/lib/jvm/java-1.5.0-sun/jre/bin/java</strong><br><br>## Multimedia Codecs<br># <strong>sudo apt-get install w32codecs</strong><br># <strong>sudo apt-get install gstreamer0.10-plugins-base</strong><br># <strong>sudo apt-get install gstreamer0.10-plugins-good</strong><br># <strong>sudo apt-get install gstreamer0.10-plugins-ugly</strong><br># <strong>sudo apt-get install gstreamer0.10-plugins-ugly-multiverse</strong><br># <strong>sudo apt-get install gstreamer0.10-plugins-bad</strong><br># <strong>sudo apt-get install gstreamer0.10-plugins-bad-multiverse</strong><br># <strong>sudo apt-get install gstreamer0.10-pitfdll</strong><br># <strong>sudo apt-get install gstreamer0.10-gl</strong><br># <strong>sudo apt-get install gstreamer0.10-ffmpeg</strong><br># <strong>sudo apt-get install vorbis-tools</strong><br># <strong>sudo apt-get install lame</strong><br># <strong>sudo apt-get install sox</strong><br># <strong>sudo apt-get install ffmpeg</strong><br># <strong>sudo apt-get install mjpegtools</strong><br><br>## DVD playback<br># <strong>sudo apt-get install libdvdcss2</strong><br># <strong>sudo apt-get install libdvdread3</strong><br># <strong>sudo apt-get install libdvdplay0</strong><br># <strong>sudo apt-get install libdvdnav4</strong><br># <strong>sudo apt-get install totem-xine</strong><br># <strong>sudo apt-get install libxine-extracodecs</strong><br># <strong>sudo apt-get install totem-xine-firefox-plugin</strong><br># <strong>sudo apt-get install vlc</strong><br># <strong>sudo apt-get install mplayer</strong><br><br>## CD/DVD burning<br># <strong>sudo apt-get install gnomebaker</strong><br># <strong>sudo apt-get install k3b</strong><br># <strong>sudo apt-get install k3b-i18n</strong><br>#<br># <strong>cd /tmp</strong><br># <strong>wget ftp://ftp4.usw.nero.com/nerolinux-2.1.0.4b-x86.deb</strong><br># <strong>sudo apt-get install libgtk1.2</strong><br># <strong>sudo dpkg -i nerolinux-2.1.0.4b-x86.deb</strong><br><br>## Thunderbird<br># <strong>sudo apt-get install mozilla-thunderbird</strong><br># <strong>sudo apt-get install mozilla-thunderbird-enigmail</strong><br><br>## Wine<br># <strong>sudo apt-get install wine msttcorefonts</strong><br><br>## Compilers and manual pages<br># <strong>sudo apt-get install build-essential manpages-dev</strong><br><br>## serveral games<br># <strong>sudo apt-get install btanks</strong><br># <strong>sudo apt-get install gnome-games sgt-puzzles</strong><br><br>## Opera<br># <strong>sudo apt-get install opera</strong><br><br>## NFS, NIS and NTP<br># <strong>sudo apt-get install nfs-common</strong><br># <strong>sudo apt-get install nis</strong><br># <strong>sudo apt-get install ntp</strong><br><br>## NTFS filesystem with read/write support<br># <strong>sudo apt-get install ntfs-config</strong><br># <strong>sudo ntfs-config</strong><br><br>## Rootkit detection<br># <strong>sudo apt-get install chkrootkit rkhunter</strong><br># <strong>chkrootkit</strong><br># <strong>rkhunter –checkall</strong><a name="5">5. Installing and configuring SSH server</a><p>Next install and configure SSH server to allow only your normal users to login. If your system has usernames <code>jane</code> and <code>john</code> make sure <code>/etc/ssh/sshd_config</code> has these lines. Launch <strong>Applications &gt; Accessories &gt; Terminal</strong>. Modify the settings and restart the SSH server.</p># <strong>sudo apt-get install openssh-server</strong><br># <strong>sudo gedit /etc/ssh/sshd_config</strong><br><br>Protocol 2<br>…<br>PermitRootLogin no<br>…<br>AllowUsers jane john<br><br># <strong>sudo /etc/init.d/ssh restart</strong><a name="6">6. Configuring X</a><p>If you have an NVIDIA graphics card (I have GeForce FX 5200) it might be a good idea to install the accelerated driver for X. Otherwise the screen might be the bottleneck when using graphics intensive applications like DVD players and games.</p># <strong>sudo apt-get install nvidia-glx nvidia-kernel-common</strong><br># <strong>sudo nvidia-glx-config enable</strong><p>For ATI cards, type the following commands:</p># <strong>sudo apt-get install xorg-driver-fglrx</strong><br># <strong>sudo dpkg-reconfigure xserver-xorg</strong><br>## Select the &quot;fglrx&quot; driver instead of &quot;ati&quot;<br><br># <strong>sudo gedit /etc/X11/xorg.conf</strong><br>## Make sure you have the following settings<br>Section &quot;Device&quot;<br> Identifier &quot;ATI Graphics Adapter&quot;<br> <strong>Driver  fglrx&quot;</strong><br> <strong>Option  &quot;VideoOverlay&quot; &quot;on&quot;</strong><br> BusID  &quot;PCI:1:0:0&quot;<br>EndSection<p>After reboot you can test that the accelerated driver is really used with the following command:</p># <strong>glxinfo | grep -i direct</strong><br>direct rendering: Yes<p>At work I also have NVIDIA GeForce FX 5200 (with one DVI and one VGA connector) and two 20&quot; Dell 2007FP TFTs. As I write code during day time it’s nice to have two monitors side by side forming a big desktop, one for writing code and compiling the code, and the other for debugging with DDD and network monitoring with wireshark. I got TwinView working with this <a href="http://users.piuha.net/martti/comp/ubuntu/xorg.conf" target="_blank" rel="external">xorg.conf</a> file.</p><a name="7">7. Installing VMware Workstation</a><p><a href="http://www.vmware.com/products/ws/" target="_blank" rel="external">VMware Workstation</a> is a commercial virtualization software which enables you to run Windows on your Linux PC.</p># <strong>sudo apt-get install build-essential linux-headers-<code>uname -r</code></strong><br><br># <strong>tar xzf VMware-workstation-6.0.0-45731.i386.tar.gz -C /tmp</strong><br># <strong>cd /tmp/vmware-distrib</strong><br># <strong>sudo ./vmware-install.pl</strong><a name="8">8. Installing VMware Server</a><p><a href="http://www.vmware.com/products/server/" target="_blank" rel="external">VMware Server</a> is a free software which enables you to run Windows on your Linux PC. See a <a href="http://users.piuha.net/martti/comp/ubuntu/server.html#6" target="_blank" rel="external">separate document</a> how I installed VMware Server. Please note that unlike with VMware Player, you can create virtual machines with VMware Server.</p><a name="9">9. Installing VMware Player</a><p><a href="http://www.vmware.com/products/player/" target="_blank" rel="external">VMware Player</a> is a free software which enables you to run Windows on your Linux PC. This needs an existing virtual machine which can be created with the non-free VMware Workstation, with the free <a href="http://fabrice.bellard.free.fr/qemu/" target="_blank" rel="external">QEMU</a> and with the free <a href="http://www.consolevision.com/members/dcgrendel/vmxform.html" target="_blank" rel="external">VM Builder</a>.</p><p>Note: VMware Workstation installs also the VMware Player so these steps are only needed if you don’t have a VMware Workstation license.</p># <strong>sudo apt-get install vmware-player</strong><a name="10">10. DMA settings</a><p>IDE hard disk and IDE CD-ROM</p># <strong>sudo gedit /etc/hdparm.conf</strong><br><br># In this example /dev/hda is the hard disk<br>/dev/hda {<br>        io32_support = 1<br>        dma = on<br>}<br><br># In this example /dev/hdc is the CD-ROM<br>/dev/hdc {<br>        io32_support = 1<br>        dma = on<br>}<br><br># <strong>sudo /etc/init.d/hdparm restart</strong><p>SATA hard disk and IDE CD-ROM</p># <strong>sudo gedit /etc/hdparm.conf</strong><br><br># In this example /dev/hdc is the CD-ROM<br>/dev/hdc {<br>        io32_support = 1<br>        dma = on<br>}<br><br># <strong>sudo /etc/init.d/hdparm restart</strong><p>Test the DMA settings with</p># <strong>sudo hdparm /dev/hdc</strong><br><br>/dev/hdc:<br> IO_support   =  1 (32-bit)<br> unmaskirq    =  0 (off)<br> using_dma    =  1 (on)<br> keepsettings =  0 (off)<br> readonly     =  0 (off)<br> readahead    = 256 (on)<br> HDIO_GETGEO failed: Invalid argument<a name="11">11. Configuring firewall</a><p>Even though Ubuntu does not listen to any non-localhost ports by default I want to limit how my PC is visible to others. This is done by using the standard <a href="http://www.netfilter.org/" target="_blank" rel="external">iptables</a> firewall which is included in the Ubuntu installation. You could of course install <a href="http://www.fs-security.com/" target="_blank" rel="external">Firestarter</a> or <a href="http://www.simonzone.com/software/guarddog/" target="_blank" rel="external">GuardDog</a> from the Synaptic package manager but I prefer a simple textfile-based solution.</p><p>Download <a href="http://users.piuha.net/martti/comp/ubuntu/firewall" target="_blank" rel="external">this firewall script</a> to your Desktop and modify it according to your network settings.</p># <strong>gedit ~/Desktop/firewall</strong><br><br># <strong>sudo cp ~/Desktop/firewall /etc/init.d/firewall</strong><br># <strong>sudo chmod 755 /etc/init.d/firewall</strong><br># <strong>sudo ln -sf ../init.d/firewall /etc/rcS.d/S42firewall</strong><br># <strong>sudo /etc/rcS.d/S42firewall restart</strong><a name="12">12. Useful links</a><ul> <li><a href="https://wiki.ubuntu.com/DapperReleaseNotes/UbiquityKnownIssues" target="_blank" rel="external">https://wiki.ubuntu.com/DapperReleaseNotes/UbiquityKnownIssues</a></li> <li><a href="https://wiki.ubuntu.com/EdgyKnownIssues" target="_blank" rel="external">https://wiki.ubuntu.com/EdgyKnownIssues</a></li></ul><ul> <li><a href="http://www.ubuntulinux.org/" target="_blank" rel="external">http://www.ubuntulinux.org/</a></li> <li><a href="http://easylinux.info/wiki/Ubuntu" target="_blank" rel="external">Ubuntu Guide</a></li> <li><a href="http://doc.gwos.org/index.php/Main_Page" target="_blank" rel="external">Ubuntu Document Storage Facility</a></li> <li><a href="http://www.mrbass.org/linux/ubuntu/" target="_blank" rel="external">http://www.mrbass.org/linux/ubuntu/</a></li></ul><ul> <li><a href="http://www.easyvmx.com/" target="_blank" rel="external">EasyVMX!: Virtual Machine Creator</a></li> <li><a href="http://www.consolevision.com/members/dcgrendel/vmxform.html" target="_blank" rel="external">VM Builder</a></li> <li><a href="http://johnbokma.com/vmware-player/create-virtual-machines.html" target="_blank" rel="external">Create your own Virtual Machines for VMware Player</a></li> <li><a href="http://www.hackaday.com/entry/1234000153064739/" target="_blank" rel="external">VMware player modification</a></li> <li><a href="http://www.getautomatix.com/" target="_blank" rel="external">Automatix</a></li> <li><a href="http://easyubuntu.freecontrib.org/" target="_blank" rel="external">Easy Ubuntu</a></li> <li><a href="http://www.psychocats.net/ubuntu/index.php" target="_blank" rel="external">Psychocats Ubuntu page</a></li> <li><a href="http://www.lemi.fi/voikko/" target="_blank" rel="external">Voikko</a></li></ul> <p></p>

      
    </div>
    <div class="article-info article-info-index">
      
      <a href="/2008/08/29/【zz】Ubuntu-Installation/" class="archive-article-date">
  	<time datetime="2008-08-29T01:43:00.000Z" itemprop="datePublished"><i class="icon-clock"></i>2008-08-29</time>
</a>
      
      
	<div class="article-category tagcloud">
	<i class="icon-price-tags"></i>
	<a class="article-category-link" href="/categories/Linux-App/">Linux App</a>
	</div>


      <div class="clearfix"></div>
    </div>
  </div>
</article>










  
    <article id="post-Linux：Ubuntu-8-04-Arch环境" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2008/08/28/Linux：Ubuntu-8-04-Arch环境/">Linux：Ubuntu-8.04/Arch环境</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>Environment</p>
<p>&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; Arch &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;</p>
<p>==========================================================<br>Ø   <a href="http://linux.cuit.edu.cn/?p=116" target="_blank">为nautilus添加右键菜单脚本</a><br>~/.gnome2/nautilus-scripts目录下添加shell脚本</p>
<p>==========================================================<br>Ø   <a href="http://li2z.cn/2009/05/06/sox/" target="_blank">音频处理领域的瑞士军刀──SoX</a></p>
<p><a href="http://sox.sourceforge.net/" target="_blank">SoX</a> 是命令行下的一套音频处理组件,由于其功能强大,号称”音频处理领域的瑞士军刀”.<br>那么SoX到底有什么功能呢?它可以播放/转换/录制多种音频格式文件,包括但不限于mp3/wav/ogg/flac/avi/wmv/pcm/gsm等,要了解完整的支持格式,可以参见<a href="http://sox.sourceforge.net/Docs/Features" target="_blank">官网的介绍</a>.<br>其中,播放/转换/录制 分别对应 paly/sox/rec 几个命令,没错,大名鼎鼎的play命令正是SoX的组件之一,哈哈,现在感觉到它的强大了吧?<br>下面用几个例子来进一步说明,由于工作关系,经常接触到PCM和GSM的音频,幸好有SoX.就以这些文件为例,mp3之类的常用文件格式就更轻松了:</p>
<p>播放wav文件:</p>
<p>play -t wav hello-world.wav</p>
<p>播放pcm文件,由于格式的不确定性,需要指定编码方式和码率,如果给的值不对,就会听到变调的声音了,哈哈:</p>
<p>play -t raw -r 8k -e a-law hello-world.pcm</p>
<p>播放gsm文件:</p>
<p>play -t gsm hello-world.gsm</p>
<p>把gsm文件转换成wav格式:</p>
<p>sox -t gsm hello-world.gsm hello-world.wav</p>
<p>把gsm文件转换成8k采样率A率的pcm格式:</p>
<p>sox -t gsm hello-world.gsm -t raw -r 8k -e a-law hello-world.pcm</p>
<p>把wav文件转换成8k采样率A率的pcm格式:</p>
<p>sox -t wav hello-world.wav -t raw -r 8k -e a-law hello-world.pcm</p>
<p>把声卡的声音录制成wav格式,默认应该是48k采样率16bit量化的双声道Signed PCM编码.这些参数都可以指定:</p>
<p>rec -t wav rec.wav</p>
<p>厉害吧~</p>
<p>另外,值得一提的是,由于libmagic包的故障,gentoo下的sox有时候不能根据扩展名来识别声音格式了,会报 no handler for detected file type `application/octet-stream; charset=binary’ 的错误,所以上述命令都加了-t参数直接指定格式,就没问题了.</p>
<p>==========================================================<br>Ø   qemu<br>qemu-img create -b d.img -f qcow2 qcow2.img<br>创建可以take snapshot的qcow2格式的image，其中base img为d.img（ext3格式的raw img），所有对<br>disk的改动都保存到qcow2.img中，d.img为只读<br>如果想将改动写入d.img，可以Ctl+Alt+2切换到(qemu)控制台，然后输入commit all</p>
<p>qemu -hda qcow2.img -net nic,vlan=0 -net tap,vlan=0,ifname=tap0,script=no</p>
<p>==========================================================</p>
<p>Ø   关于小键盘没办法输入数字<br>变成鼠标控制键，而且numlock是启动的状态<br>按shift+alt+numLock组合键可以恢复<br>Ctrl-Alt-“＋” 或者 Ctrl-Alt-“－” 改变屏幕分辨率(提高/降低)</p>
<p>==========================================================</p>
<p>Ø   qemu-img：转换VirtualBox和VMware的disk<br>qemu-img　convert　xxx.vdi　xxx.raw<code><br></code>qemu-img　convert　xxx.raw   -O vmdk　xxx.vmdk<code><br></code>qemu-img    convert   -O vmdk    hdd.vdi    hdd.vmdk</p>
<p>==========================================================</p>
<p>Ø   aria2：Download utility that supports HTTP(S), FTP, BitTorrent, Metalink<br>aira2c –max-speed-limit 1M link_address</p>
<p>==========================================================</p>
<p>Ø   vino ：类似windows的msrtc，登录远程的Linux桌面<br>vino-preferences可以配置远程登录选项</p>
<p>==========================================================</p>
<p>Ø   Cherokee：号称目前最快的 Web 服务器软件<br>sudo cherokee -C cherokee.conf.perf_sample -r /opt/doc_root<br>配置很简单，基本不用修改就可以启动服务</p>
<p>==========================================================</p>
<p>Ø   scrot：截图工具<br>scrot -s 鼠标选中区域<br>scrot -d 5 /tmp/1.jpeg    5秒后对屏幕抓图<br>scrot ‘%Y-%m-%d_$wx$h_scrot.png’ -e ‘mv $f ~/images/shots/‘<br>Creates a file called something like 2000-10-30_2560x1024_scrot.png and moves it to your images directory.</p>
<p>==========================================================</p>
<p>Ø   imagemagick包：图片格式转换<br>convert pic.png pic.xpm<br>import -window root screen.jpg 截图整个屏幕<br>其中的root为window id，可以用xwininfo命令查看window ID<br>chvt 7 ; sleep 5 ; XAUTHORITY=/var/gdm/:0.Xauth DISPLAY=:0.0 import -window root /tmp/gdm-shot.png<br>在 tty1 中，截取 tty7 中x window登录界面 （chvt 切换终端）</p>
<p>==========================================================</p>
<p>Ø   file-roller：gnome文档管理器</p>
<p>==========================================================</p>
<p>&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; Ubuntu-8.04 &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;</p>
<p>==========================================================</p>
<p>Ø   网络嗅探器：Wireshark / snort</p>
<p>==========================================================</p>
<p>Ø   为SCIM配置快捷符号（special_table）<br>/usr/share/scim/pinyin/special_table<br>添加一行：<br>jfo = 0x3010,0x3011,0x3016,0x3017<br>重启scim，输入ijfo，将选择如下符号：<br>【】〖〗</p>
<p>==========================================================</p>
<p>Ø   Ubuntu 中的Load/Unload Cycle Count问题及解决方案<br>hdparm -B 254 /dev/sda<br><a href="http://blog.pickbox.me/2008/10/04/%E3%80%90zz%E3%80%91ubuntu%20%E4%B8%AD%E7%9A%84loadunload%20cycle%20count%E9%97%AE%E9%A2%98%E5%8F%8A%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/" target="_blank">Ubuntu 中的Load/Unload Cycle Count问题及解决方案</a></p>
<p>==========================================================</p>
<p>Ø   查看chm文件</p>
<ol>
<li>apt-get chmsee</li>
<li>apt-get install libchm-bin<br>a. chm_http –port=8000 –bind=127.0.0.1 jfo.chm，然后在浏览器里输入<a href="http://127.0.0.1:8000就可以查看了" target="_blank" rel="external">http://127.0.0.1:8000就可以查看了</a><br>b. extract_chmLib file.chm dir/ ，将chm文件extract到 dir/ 下</li>
</ol>
<p>====================================================================================================================</p>
<p>Ø   evince中文显示乱码<br>apt-get install poppler-data</p>
<p>====================================================================================================================</p>
<p>Ø   如何在ubuntu hardy下解决 intel 3945abg无线网卡 不稳定的问题<br>具体症状如下：</p>
<ol>
<li>可以识别无线网络，可以链接到无线网络。</li>
<li>刚连接上之后一段时间，速度还不错。</li>
<li>过一段时间，网络就变的很慢很慢，有时候是没有速度，有时候会断线。</li>
<li>期间偶尔会变好。<br>总体来说，就是无线网卡不稳定。<br>参考如下两种解决方法：<br><a href="http://blog.pickbox.me/2008/09/29/%E3%80%90zz%E3%80%91ubuntu%E4%B8%8Bintel%203945abg%E6%97%A0%E7%BA%BF%E7%BD%91%E5%8D%A1%E9%A9%B1%E5%8A%A8-%E4%BD%BF%E7%94%A8ipw3945%E6%9B%BF%E6%8D%A2iwl3945/" target="_blank">ubuntu下intel 3945abg无线网卡驱动——使用ipw3945替换iwl3945</a><br><a href="http://unix-cd.com/vc/www/22/2007-06/3276.html" target="_blank">使用ndiswrapper 安装windows无线网卡驱动</a></li>
</ol>
<p>====================================================================================================================</p>
<p>Ø   解决笔记本电脑音量控制快捷键在Linux的问题<br>1.音量控制的Master无效，调整PCM才能真正调节音量。<br>2.笔记本上的Fn+F3/Fn+F4等音量控制快捷方式默认控制的是Master，导致了这些快捷方式失效。<br>这样虽然能用PCM来调整音量，但是快捷键有点不方便。今天突然发现快捷键问题能够解决，在“系统－》首选项－》音效”中能够配置，选中PCM即可。<br><img class="blogimg" alt="" src="http://img.pickbox.me/wp-content/uploads/pic/b8b30bf729d5163b730eec56.jpg"><br>另外也能够修改默认的快捷键，“系统－》首选项－》键盘快捷键”中能够修改：<br><img class="blogimg" alt="" src="http://img.pickbox.me/wp-content/uploads/pic/694da34444bcd79bb3b7dc57.jpg"></p>
<p>====================================================================================================================</p>
<p>Ø   webmin：A web-based administration interface for Unix systems configuration<br>Webmin官方网站<a href="http://www.webmin.com/" target="_blank" rel="external">http://www.webmin.com/</a> 下载deb包<br>安装好后，通过以下访问webmin配置界面：<br><a href="https://loacolhost:10000/" target="_blank" rel="external">https://loacolhost:10000/</a><br>如果你的服务器没有证书，这里就会提示是否允许本次会话对话框，单击确定之后即可。</p>
<p>====================================================================================================================</p>
<p>Ø   安装 webalizer 网络数据分析工具<br>apt-get install webalizer<br>apache的日志位于 /var/log/apache/下，access.log.[1234]<br>sudo webalizer 即可生成日志分析文件，在 /var/www/webalizer/ 下可以看到</p>
<p>====================================================================================================================</p>
<p>Ø   从源代码编译debian包 &amp; 构建一个本地包发布库<br>refer <a title="常用 pacman,APT,RPM 命令参数" href="http://blog.pickbox.me/2008/08/27/%e5%b8%b8%e7%94%a8%20pacman%2capt%2crpm%20%e5%91%bd%e4%bb%a4%e5%8f%82%e6%95%b0/" target="_blank">常用 pacman,APT,RPM 命令参数</a></p>
<p>====================================================================================================================</p>
<p>Ø   HOWTO: CJK in Wine (Chinese, Japanese &amp; Korean)<br><a href="http://ubuntuforums.org/showthread.php?t=383628" target="_blank">http://ubuntuforums.org/showthread.php?t=383628</a></p>
<p>====================================================================================================================</p>
<p>Ø   Sound Troubleshooting<br><a href="https://help.ubuntu.com/community/SoundTroubleshooting?highlight=(sound)#head-d8ad2bdeea082f749845b766aa82831110042360" target="_blank">https://help.ubuntu.com/community/SoundTroubleshooting?highlight=(sound)#head-d8ad2bdeea082f749845b766aa82831110042360</a></p>
<p>====================================================================================================================</p>
<p>Ø   nm-applet</p>
<p><ul><br>    <li>Alt/F2, run <em>nm-applet</em>, and the network icon will return</li><br>    <li>restart Network Manager:</li></ul></p>
<h1 id=""><a href="#" class="headerlink" title=""></a></h1><p>Ø   Linux添加新字体<br>以微软雅黑字体为例（其他的宋体、黑体等点阵字体都一样的），我们的雅黑字体文件是：Yahei.ttf</p>
<p>1、在fonts下新建一个vistaFonts目录，准备把从windows下拷贝过来的字体都放在这个目录里，这里就是把雅黑字体放进来<br>代码:<br>sudo mkdir -p /usr/share/fonts/vistaFonts<br>sudo cp Yahei.ttf /usr/share/fonts/vistaFonts/</p>
<p>然后，改变权限：<br>代码:<br>sudo chmod 644 /usr/share/fonts/vistaFonts/Yahei.ttf (改成755也没问题的，但起码要444)</p>
<p>开始安装：<br>cd /usr/share/fonts/vistaFonts/<br>sudo mkfontscale<br>sudo mkfontdir<br>sudo fc-cache -fv</p>
<p>至此雅黑安装完成。</p>
<p>万恶的“MS－雅黑”字体都会装了，按照上面的步骤，微软的其他的字体应该也会装了把，当然，我可没让你们用盗版阿。</p>
<p>至于文泉驿的字体，好像是有deb包的把，很方便，不行就去官方网站上看下，很详细的安装步骤。</p>
<p>====================================================================================================================</p>
<p>Ø   ls、PS1、grep、manpage的颜色<br>一、ls</p>
<p>对于ls输出，除了加上 –color=auto这样的参数来接受系统默认的设置以外，我们可以为某种文件类型选择颜色。<br>Fedora、Suse、Gentoo中一般都会有颜色的配置文件 /etc/DIR_COLORS 。在Debian/Ubuntu中如果没有的话，可以:</p>
<h1 id="dircolors-p-gt-etc-DIR-COLORS-或者"><a href="#dircolors-p-gt-etc-DIR-COLORS-或者" class="headerlink" title="dircolors -p &gt; /etc/DIR_COLORS   或者"></a>dircolors -p &gt; /etc/DIR_COLORS   或者</h1><h1 id="dircolors-p-gt-dir-colors"><a href="#dircolors-p-gt-dir-colors" class="headerlink" title="dircolors -p &gt; ~/.dir_colors"></a>dircolors -p &gt; ~/.dir_colors</h1><p>但dircolors程序不会去主动识别配置文件，需要在~/.bashrc中写上：<br>export LS_OPTIONS=’-aCF –color=auto’<br>eval “<code>dircolors -b /etc/DIR_COLORS</code>“<br>alias ls=’ls $LS_OPTIONS’<br>例如，设计一种特殊的文件结尾.É，并把这种文件的颜色在/etc/DIR_COLORS里写上：<br>.É 01;36</p>
<h1 id="eval-“dircolors-b-etc-DIR-COLORS“"><a href="#eval-“dircolors-b-etc-DIR-COLORS“" class="headerlink" title="eval “dircolors -b /etc/DIR_COLORS“"></a>eval “<code>dircolors -b /etc/DIR_COLORS</code>“</h1><p>这样作以后，环境变量LS_COLORS会按照颜色配置文件中的设置发生变化。于是，用ls就可以看到这种文件的颜色了。</p>
<p>二、PS1</p>
<p>下面这个PS1颜色是我的Gentoo中的默认设置：</p>
<h1 id="export-PS1-’-�33-01-31m-h-�33-01-34m-W-�33-00m-‘"><a href="#export-PS1-’-�33-01-31m-h-�33-01-34m-W-�33-00m-‘" class="headerlink" title="export PS1=’[�33[01;31m]h[�33[01;34m] W $[�33[00m] ‘"></a>export PS1=’[�33[01;31m]h[�33[01;34m] W $[�33[00m] ‘</h1><p>三、grep</p>
<p>对于grep来说，加参数–colour=auto可以使用颜色:</p>
<h1 id="alias-grep-’grep-–colour-auto’"><a href="#alias-grep-’grep-–colour-auto’" class="headerlink" title="alias grep=’grep –colour=auto’"></a>alias grep=’grep –colour=auto’</h1><p>这种颜色也可以通过设置GREP_COLOR环境变量来调配：</p>
<h1 id="export-GREP-COLOR-’1-37-41’-—红底白字"><a href="#export-GREP-COLOR-’1-37-41’-—红底白字" class="headerlink" title="export GREP_COLOR=’1;37;41’ —红底白字"></a>export GREP_COLOR=’1;37;41’ —红底白字</h1><p>四、manpage</p>
<p>下面是从linuxsir论坛转来的某位仁兄的关于manpage的颜色的设置：<br>export LESS_TERMCAP_mb=$’E[01;31m’<br>export LESS_TERMCAP_md=$’E[01;31m’<br>export LESS_TERMCAP_me=$’E[0m’<br>export LESS_TERMCAP_se=$’E[0m’<br>export LESS_TERMCAP_so=$’E[01;44;33m’<br>export LESS_TERMCAP_ue=$’E[0m’<br>export LESS_TERMCAP_us=$’E[01;32m’</p>
<p>====================================================================================================================</p>
<p>Ø   Ubuntu中安装GBK locale<br>Ubuntu默认安装的中文环境为zh_CN.utf8,然后很多windows的文档还是以GB2312或GBK编码保存的,<br>因此十分有必要<br>在Ubuntu下生成GBK或GB2312的locale.具体方法如下:</p>
<p>1.修改/var/lib/locales/supported.d/local文件,在文件中添加<br>zh_CN.GBK GBK<br>zh_CN.GB2312 GB2312</p>
<p>2.sudo dpkg-reconfigure –force locales<br>或者sudo locale-gen<br>然后在输出的结果中会出现<br>zh_CN.GB2312 done<br>zh_CN.GBK done<br>生成locale在/usr/lib/locale/</p>
<p>====================================================================================================================</p>
<p>Ø   设置在英文环境下也能调用中文输入法<br>编辑 /etc/gtk-2.0/gtk.immodules(如果存在的话) 或者 /usr/lib/gtk-2.0/2.10.0/immodule-files.d/libgtk2.0-0.immodules 文件，在xim 的 local 增加 en 也就是说：<br>“xim” “X Input Method” “gtk20” “/usr/share/locale” “ko:ja:th:zh”<br>改成<br>“xim” “X Input Method” “gtk20” “/usr/share/locale” “en:ko:ja:th:zh”</p>
<p>====================================================================================================================</p>
<p>Ø   切换输入法<br>im-switch -s scim<br>或<br>修改~/.xinput.d/zh_CN 但link就行了</p>
<p>启动时输入法的设置参见配置文件/etc/X11/Xsession.d/80im-switch</p>
<p>====================================================================================================================</p>
<p>Ø   /var/lib/dpkg下各个文件用途</p>
<p>/var/lib/dpkg/status<br>记录安装信息，将install改为purge，则apt-get、dpkg、aptitude等认为软件包已经remove掉了，达到欺骗效果</p>
<p>/var/lib/dpkg/available<br>dpkg -p/–print-avail时用到</p>
<p>/var/lib/dpkg/info/<br>记录已经安装包的各种信息<br>pkg.conffiles:配置文件信息<br>pkg.list:文件安装路径<br>pkg.preinst,pkg.prerm,pkg.postinst:安装之前或之后的动作<br>pkg.shlibs:共享库信息</p>
<p>====================================================================================================================</p>
<p>Ø   miscellaneous<br>/etc/alternatives/vim指向你真实所用的vim，你安装完full以后就是vim.full，tiny不需要强制卸载，可以完全共存，需要用的话只要调整alternatives就可以了<br>cat /proc/sys/vm/laptop_mode<br>/etc/default/acpi-support<br>/etc/alternative<br>cpufreq-set -g [ondemand|powersave]<br>sudo iwconfig wlan0 power off<br>sudo route del -net default dev eth0<br>export http_proxy=<br>sudo apt-get install wine msttcorefonts<br>sudo apt-get install build-essential manpages-dev<br>apt-get –no-upgrade<br>apt-get source –only-source pkg<br>cat /proc/net/nf_conntrack<br>/etc/X11/Xsession.d<br>update-fonts-alias misc (/etc/X11/fonts/misc)<br>locale -a|grep zh_CN<br>sudo locale-gen (/usr/lib/locale/zh_CN.utf8)<br>字体列表: xlsfonts或 fc-list (取=前面)<br>pppd: point-to-point protocol daemon<br>pptpd: pop-top daemon/point-to-point tunneling protocol<br>CHAP: 加密握手认证协议（Crypto Handshake Auth Protocol）<br>PAP: Peer认证协议（Peer Authentication Protocol）<br>Chat: 使用“Chat”作为 login:/password：认证方式<br>ip route add 10.0.0.0/8 via $gateway dev eth0<br>route add -net 10.0.0.0 netmask 255.0.0.0 gw $gateway dev eth0<br>ip route add 10.0.0.0/8 dev eth0<br>route add -net 10.0.0.0 netmask 255.0.0.0 dev eth0<br>ifconfig ppp1 pointopoint 10.0.0.1<br>ip addr add $localaddress peer 10.0.0.1/32 dev ppp1<br>/proc/asound/modules<br>/proc/net/nf_conntrack<br>/proc/sys/net/ipv4/ip_forward<br>/etc/event.d/rc-default<br>runlevel 显示当前所处的runlevel<br>telinit 2 切换到runlevel 2<br>gnome-keybinding：设置系统快捷键<br>gnome-calculator：计算器<br>gnome-network-preferences：全局网络代理设置<br>gnome-system-log：查看系统日志，包括syslog,messages,kern.log,debug,user.log,Xorg.0.log等<br>gnome-system-monitor：系统监视器<br>gnome-sound-properties：声音首选项<br>gnome-power-preferences：电源管理首选项<br>gnome-device-manager：显示系统所有设备<br>hotwire : better than Gnome-terminal,文字图形结合<br>Tunapie - Linux下的网络电台<br>Tribler 就像是Azureus的Vuze版，提供视频资源下载<br>webmin :<br>readlink</p>
<p>====================================================================================================================</p>
<p><del>end</del></p>

      
    </div>
    <div class="article-info article-info-index">
      
      <a href="/2008/08/28/Linux：Ubuntu-8-04-Arch环境/" class="archive-article-date">
  	<time datetime="2008-08-28T11:38:00.000Z" itemprop="datePublished"><i class="icon-clock"></i>2008-08-28</time>
</a>
      
      
	<div class="article-category tagcloud">
	<i class="icon-price-tags"></i>
	<a class="article-category-link" href="/categories/Linux-App/">Linux App</a>
	</div>


      <div class="clearfix"></div>
    </div>
  </div>
</article>










  
  
    <nav id="page-nav">
      <a class="extend prev" rel="prev" href="/page/34/">&laquo; Prev</a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/33/">33</a><a class="page-number" href="/page/34/">34</a><span class="page-number current">35</span><a class="page-number" href="/page/36/">36</a><a class="page-number" href="/page/37/">37</a><span class="space">&hellip;</span><a class="page-number" href="/page/60/">60</a><a class="extend next" rel="next" href="/page/36/">Next &raquo;</a>
    </nav>
  


      </div>
      <footer id="footer">
  <div class="outer">
    <div id="footer-info">
    	<div class="footer-left">
    		&copy; 2016 jfo
    	</div>
      	<div class="footer-right">
      		<a href="http://hexo.io/" target="_blank">Hexo</a>  Theme <a href="https://github.com/litten/hexo-theme-yilia" target="_blank">Yilia</a> by Litten
      	</div>
    </div>
  </div>
</footer>
    </div>
    <script>
	var yiliaConfig = {
		fancybox: true,
		mathjax: false,
		animate: true,
		isHome: true,
		isPost: false,
		isArchive: false,
		isTag: false,
		isCategory: false,
		open_in_new: false,
		root: "/",
		innerArchive: true
	}
</script>

<script src="/./main.js"></script>


    
<div class="tools-col">
  <ul class="btn-wrap">
    
      <li class="chose" data-hook="tools-section-all"><span class="text">全部</span><i class="icon-book"></i></li>
    
    
      <li data-hook="tools-section-tag"><span class="text">标签</span><i class="icon-price-tags"></i></li>
    
    
      <li data-hook="tools-section-friends"><span class="text">友链</span><i class="icon-link"></i></li>
    
    
      <li data-hook="tools-section-me"><span class="text">我</span><i class="icon-smile"></i></li>
    
  </ul>
  <div class="tools-wrap">
    
    	<section class="tools-section tools-section-all chose">
    	</section>
    

    
    	<section class="tools-section tools-section-tag">
    			<div class="widget tagcloud" id="js-tagcloud">
    				<ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Android/">Android</a><span class="category-list-count">87</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Arduino-OpenWrt/">Arduino/OpenWrt</a><span class="category-list-count">14</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/DefaultCategory/">DefaultCategory</a><span class="category-list-count">9</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Distributed-Computing/">Distributed Computing</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/English/">English</a><span class="category-list-count">20</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Google/">Google</a><span class="category-list-count">5</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Java/">Java</a><span class="category-list-count">25</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Life/">Life</a><span class="category-list-count">67</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Linux/">Linux</a><span class="category-list-count">52</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Linux-App/">Linux App</a><span class="category-list-count">61</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Linux-Debug/">Linux Debug</a><span class="category-list-count">15</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Linux-Virtualization/">Linux Virtualization</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Mac-OS-X/">Mac OS X</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Mobile/">Mobile</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Network/">Network</a><span class="category-list-count">18</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Saying/">Saying</a><span class="category-list-count">10</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/WebDev/">WebDev</a><span class="category-list-count">6</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Windows/">Windows</a><span class="category-list-count">18</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/c-c-template-gp-boost/">c++/c++ template/gp/boost</a><span class="category-list-count">14</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/c-c-algorithm/">c/c++/algorithm</a><span class="category-list-count">36</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/cocos2d-x-模拟器/">cocos2d-x/模拟器</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/com组件/">com组件</a><span class="category-list-count">7</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/framework/">framework</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/gcc-binutils-make-共享库/">gcc/binutils/make/共享库</a><span class="category-list-count">21</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/iOS/">iOS</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/js-html-python/">js/html/python</a><span class="category-list-count">6</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/l4ka-pistachio-iguana/">l4ka::pistachio/iguana</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/linux-图形/">linux 图形</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/python-js-php-html-mysql-http/">python/js/php/html/mysql/http</a><span class="category-list-count">46</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/reading/">reading</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/self-collect/">self_collect</a><span class="category-list-count">17</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/unifiedkernel-wine-reactos/">unifiedkernel/wine/reactos</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/wordpress/">wordpress</a><span class="category-list-count">7</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/产品/">产品</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/教育/">教育</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/数学-物理/">数学/物理</a><span class="category-list-count">3</span></li></ul>
    			</div>
    	</section>
    

    
    	<section class="tools-section tools-section-friends">
  		
  			<div class="friends-wrap" id="js-friends">
  			
  	          <a target="_blank" class="main-nav-link switch-friends-link" href="http://iguangba.pickbox.me/">爱逛吧</a>
  	        
  	          <a target="_blank" class="main-nav-link switch-friends-link" href="http://www.pickbox.me/">收藏夹</a>
  	        
  	          <a target="_blank" class="main-nav-link switch-friends-link" href="http://note.pickbox.me/">网络剪贴板</a>
  	        
  	        </div>
  		
    	</section>
    

    
    	<section class="tools-section tools-section-me">
  	  	
  	  		<div class="aboutme-wrap" id="js-aboutme">jfojfo#gmail.com</div>
  	  	
    	</section>
    
  </div>
  
</div>

    <!-- Root element of PhotoSwipe. Must have class pswp. -->
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    <!-- Background of PhotoSwipe. 
         It's a separate element as animating opacity is faster than rgba(). -->
    <div class="pswp__bg"></div>

    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">

        <!-- Container that holds slides. 
            PhotoSwipe keeps only 3 of them in the DOM to save memory.
            Don't modify these 3 pswp__item elements, data is added later on. -->
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                <!--  Controls are self-explanatory. Order can be changed. -->

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" style="display:none" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                <!-- Preloader demo http://codepen.io/dimsemenov/pen/yyBWoR -->
                <!-- element will get class pswp__preloader--active when preloader is running -->
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                      <div class="pswp__preloader__cut">
                        <div class="pswp__preloader__donut"></div>
                      </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div> 
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div>
  </div>
</body>
</html>